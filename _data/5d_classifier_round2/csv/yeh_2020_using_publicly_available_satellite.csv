page,p
1,"article https://doi.org/10.1038/s41467-020-16185-w open using publicly available satellite imagery and deep learning to understand economic well-being in africa christopher yeh 1,7, anthony perez 1,2,7, anne driscoll3, george azzari2,4, zhongyi tang5, david lobell3,4,5, stefano ermon 1 & marshall burke 3,4,5,6 ✉ 1234567890():,; accurate and comprehensive measurements of economic well-being are fundamental inputs into both research and policy, but such measures are unavailable at a local level in many parts of the world."
1,"here we train deep learning models to predict survey-based estimates of asset wealth across ~ 20,000 african villages from publicly-available multispectral satellite ima- gery."
1,"models can explain 70% of the variation in ground-measured village wealth in countries where the model was not trained, outperforming previous benchmarks from high-resolution imagery, and comparison with independent wealth measurements from censuses suggests that errors in satellite estimates are comparable to errors in existing ground data."
1,"satellite- based estimates can also explain up to 50% of the variation in district-aggregated changes in wealth over time, with daytime imagery particularly useful in this task."
1,"we demonstrate the utility of satellite-based estimates for research and policy, and demonstrate their scalability by creating a wealth map for africa’s most populous country."
1,"1 department of computer science, stanford university, 353 serra mall, stanford, ca 94305, usa."
1,"2 atlasai, 459 hamilton ave, palo alto, ca 94301, usa."
1,"3 center on food security and the environment, stanford university, 616 jane stanford way, stanford, ca 94305, usa."
1,"4 department of earth system science, stanford university, 473 via ortega, stanford, ca 94305, usa."
1,"5 stanford institute for economic policy research, stanford university, 366 galvez st, stanford, ca 94305, usa."
1,"6 national bureau of economic research, 1050 massachusetts avenue, cambridge, ma 02138-5398, usa."
1,"7these authors contributed equally: christopher yeh, anthony perez. ✉email: mburke@stanford.edu nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 1"
2,"article nature communications | https://doi.org/10.1038/s41467-020-16185-w l ocal-level measurements of human well-being are important lights imagery can measure country-level economic performance for informing public service delivery and policy choices by over time7, and that high-resolution (<1 m/pixel) imagery from governments, for targeting and evaluating livelihood pro- private-sector providers can be used to measure spatial variation grams by governmental and non-governmental organizations, in local economic outcomes in a handful of developing and and for the development and deployment of new products and middle-income countries8–12."
2,our focus is on using multiple services by the private sector.
2,"while recent work has generated sources of spatially coarser public imagery to infer both spatial granular estimates of a range of human and physical capital and temporal differences in local-level economic well-being measures in parts of the developing world1–5, similar data on key across sub-saharan africa, including for countries where reli- economic indicators remain lacking, constraining even basic able survey data do not yet exist and where survey-based inter- efforts to characterize who and where the poor are. polation methods might struggle to generate accurate estimates."
2,"for example, at least 4 years pass between nationally repre- we ﬁnd that a deep learning model trained on this imagery is sentative consumption or asset wealth surveys in the majority of able to explain ~70% of the spatial variation in ground-measured african countries (fig. 1a), the key source of data for inter- village-level asset wealth across africa, and up to 50% of temporal nationally comparable poverty measurements."
2,these surveys have variation when aggregating to the district level.
2,"we show that limited repeated observation of individual locations, making it model performance is limited in large part by noise in the training difﬁcult to measure local changes in well-being over time, and data."
2,we then demonstrate how our estimates could potentially public release of any disaggregated consumption data from be used to help target social programs and further understand the african countries is very rare.
2,"at current survey frequencies, we determinants of well-being across the developing world. calculate that a given african household will appear in a house- to develop our models, we assemble data on asset wealth for hold well-being survey less than once every 1000 years, or about >500k households living in 19,669 villages across 23 countries in two orders of magnitude less frequently than a household in the africa, drawn from nationally representative demographic and united states (fig. 1b)."
2,"while not all households need to be health surveys (dhs) conducted between the years 2009 and observed to generate accurate economic estimates, sampling 2016 (supplementary fig."
2,"1, supplementary table s1)."
2,"we enough households to generate frequent and reliable national- focus on asset wealth rather than other welfare measurements level statistics is alone likely to be expensive, requiring an esti- (e.g. consumption expenditure) as asset wealth is thought to be a mated $1 billion usd annual investment in lower-income less-noisy measure of households’ longer-run economic well- countries to measure a range of indicators relevant to the sus- being13,14, is a common component of multi-dimensional poverty tainable development goals6."
2,"expanding these efforts to generate measures used by development practitioners around the world, is reliable estimates at the local level would add dramatically to actively used as a means to target social programs14,15, and is these costs. much more widely observed in publicly available georeferenced although existing data are scarce and traditional collection african survey data."
2,"following standard approaches13,16, for each methods expensive to scale, other potentially relevant data for the household we compute a wealth index from the ﬁrst principal measurement of well-being are being collected increasingly fre- component of survey responses to questions about ownership of quently."
2,"for instance, while most african households are never speciﬁc assets (“methods”)."
2,"we pool all households in our sample observed in consumption or wealth surveys, their location in the principal components estimation such that the derived appears on average at least weekly in cloud-free imagery from index is consistent over both space and time, and then average multiple satellite-based sensors (fig. 1b), and will have been household values to the enumeration area level (also called observed in multispectral imagery at least annually for more than clusters, and roughly equivalent to villages in rural areas or a decade. neighborhoods in urban areas), the level at which geocoordinates here we study whether such imagery can be used to accurately are available in the public survey data."
2,this approach assumes measure local-level well-being over both space and time in africa. that assets contribute similarly to wealth across all countries in earlier work demonstrated that coarse (1 km/pixel) nighttime our data.
2,"alternative methods of constructing the index using a b 1 planetscope (3m) avg. household revisit interval (days) a week sentinel 2 (10m) landsat 5-8 (30m) a month 100 digital globe (<1m) a year rapid eye (5m) years between wealth 10 years and consumption surveys 10,000 economic surveys in the usa (1, 2] 100 years (2, 3] (3, 4] 1000 years (4, 5] 1,000,000 economic surveys (5, 10] 13,500 years in africa > 10 never 2000 2002 2004 2006 2008 2010 2012 2014 2016 2018 year fig."
2,"1 economic data from household surveys are infrequent in many african countries. a frequency of nationally representative household consumption expenditure or asset wealth surveys across africa, 2000–2016. b average household revisit rate for surveys and average location revisit rate for various resolutions of satellite imagery over time."
2,"survey revisit rate, the average time elapsed between observations of a given household in nationally representative expenditure or wealth surveys, is calculated as number of total person-days (population × 365) divided by the number of person-days observed in a given year."
2,"satellite revisit rate estimates are calculated as the number of days in a year divided by the average number of images taken in a year across 500 randomly sampled dhs clusters in african countries, only counting images with <30% cloud cover."
2,2 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications
3,"nature communications | https://doi.org/10.1038/s41467-020-16185-w article only directly observable subsets of these assets, or which allow the transfer learning approach8."
3,"perhaps surprisingly, this trend mapping of assets to the wealth index to differ by country and holds even for highly data-limited settings: even when trained on year, yield very similar wealth estimates (supplementary fig."
3,"s2), data from only 5% of the surveyed clusters (n < 1000), our best and the wealth index is highly correlated with log consumption models trained end-to-end outperform transfer learning (fig. 3c). expenditure (weighted r2 = 0.5, supplementary fig."
3,"s3) in a small a nearest neighbor model that predicts wealth in a given subset of countries where consumption data are available. location from wealth in locations with similar nightlights values we then train a convolutional neural network (cnn) to pre- performs nearly as well as the deep learning models in predicting dict the village- and year-speciﬁc measure of wealth, using tem- spatial variation, and much better than a linear model using scalar porally and spatially matched multispectral daytime imagery nightlights as input (fig. 3a, b)—although neither nightlights from 30m/pixel landsat and <1 km/pixel nighttime lights ima- models are predictive of temporal changes in wealth, while gery as inputs (see “methods”)."
3,unlike earlier approaches that daytime models are (see below).
3,"these results suggest that non- used nighttime light intensity as intermediate labels for training a linearities and/or spatial structure in nightlights is important for cnn feature extractor on daytime imagery8, we instead incor- explaining spatial variation in well-being, and also may help porate both sets of imagery in a deep learning model trained end- explain why the transfer learning approach, which only predicts a to-end, with models trained separately on daytime and nighttime scalar nighttime light intensity from daytime images, performs images and then joined in a ﬁnal fully connected layer."
3,"the goal worse than end-to-end training. of the model is to learn features in the daytime and nighttime imagery that are predictive of asset wealth, without ﬁrst pre- scribing what features the model should look for."
3,we compare predictive performance over time.
3,"many research and policy performance of this dual-input combined model to models applications require estimates of changes in economic measures trained only on nightlights or on landsat multispectral imagery, over time as well as over space."
3,"there are important challenges, as well as to a transfer learning approach that uses nightlights as however, in using available ground surveys to measure changes in intermediate labels to ﬁnd wealth-relevant features in the multi- economic outcomes over time at a local level, as well as in eval- spectral landsat imagery8."
3,we evaluate models using both pooled uating our deep learning approach’s ability to do so.
3,"first, most cross-country wealth data as well as only within-country data, existing surveys do not repeatedly measure outcomes at the same and evaluate their ability to predict variation in well-being over locations over time, i.e. they are not panel data; the dhs surveys, space, and to predict changes over time."
3,"all evaluation is done on for instance, draw a new sample of clusters each survey round. held-out test locations that the model did not use in training, an second, temporal changes over a few-year time span are likely to approach that limits overﬁtting as well as replicates the real-world be small relative to cross-sectional differences, and any random setting of making predictions where ground data do not exist. noise in each year’s survey will diminish the signal in these changes."
3,"given these challenges, we take three approaches to measuring results and predicting changes in wealth over time."
3,we ﬁrst use repeated predictive performance over space.
3,"our combined model is rounds of dhs surveys and spatially match a cluster in one predictive of cluster-level asset wealth, with predictions survey year to the nearest cluster in a previous survey year explaining on average 70% of the variation in ground-based (subject to the random noise added to the village locations by the wealth measurements in held-out country-years (fig. 2a)."
3,"per- survey team; see below), and compute wealth changes as the formance in individual held-out countries is never below 50% of difference in wealth index between matched pairs of clusters. variation explained, and often exceeds 80% (median = 70.4%, second, we use an independent smaller set of houeshold level fig. 2c, supplementary fig."
3,"s4), indicating our model is not panel data, the living standards measurement surveys (lsms), simply separating wealthier african countries from poorer to construct cluster-level changes in an asset wealth index."
3,"in countries, but capably differentiating wealth levels within coun- both cases, predictions from a deep learning model using imagery tries."
3,"these results exceed performance in earlier work on a as input can explain between 15% and 17% of the variation in similar task using high-resolution imagery8,11 or mobile phone survey-measured changes in asset wealth in held-out villages data17 as input, and match or exceed benchmarks for in-country (supplementary fig. 7a, b)."
3,"in contrast to our cross-sectional performance from geostatistical models used to predict health results, deep learning models using nightlights as input outcomes, standard of living, and housing quality in africa1,2,5,18 performed signiﬁcantly worse than models using multispec- (see “methods” for additional comparisons)."
3,"visualization tral daytime imagery (r2 = 0.15 vs. r2 < 0.01), likely because of model-derived features suggests that the model learns nightlights show little variation over time in our sample locations semantically-meaningful features that are intuitively related to (supplementary fig."
3,"while temporal performance in multi- wealth, including ﬁlters for urban areas, agricultural regions, spectral models remains low relative to our model’s performance water bodies, and deserts (supplementary fig."
3,"aggregating in cross section, we show in a simulation that exceeding this predictions and ground measurements to the district level further temporal performance would be difﬁcult for any model improves performance (fig. 2b, d), with predictions explaining (supplementary fig."
3,"s9, supplementary note 1), as the small on average 83% of the ground measurements in held-out average temporal change in wealth in our sample (0.08 standard countries not used to train the model."
3,improved performance deviations of our wealth index) could easily be obscured by noise with aggregation is consistent with errors cancelling when either in the two survey values being differenced. the predictions or ground data are averaged.
3,"in a third experiment, we use the same lsms data to construct notably, cnns trained only on nighttime lights (nl) or only a pca-based index of changes in asset ownership (rather than a on multispectral (ms) daytime imagery perform similarly to each change in indexes, as before) to better capture the component of other and almost as well as the combined model (ms+nl), wealth that is actually changing."
3,"by construction this index has suggesting that these two inputs contain similar information, at greater variation over time, and satellite-based features are more least for the task of predicting spatial variation in african wealth predictive (r2 = 0.35), again with the models requiring multi- (fig. 3a, b; supplementary fig."
3,"consequently, our approach spectral daytime imagery inputs in order to perform well (fig. 4a). of directly using nightlight images as model inputs performs as in the cross-sectional results, models again appear to learn better than using them indirectly as a proxy, as in an earlier features related to urbanization and to changing agricultural nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 3"
4,"article nature communications | https://doi.org/10.1038/s41467-020-16185-w a village level b district level r 2: 0.67, 0.70 r 2: 0.75, 0.83; 0.67, 0.72 weighted; unweighted 2 2 survey-measured asset wealth survey-measured asset wealth 1 1 0 0 –1 –1 –1 0 1 2 –1 0 1 2 satellite-predicted asset wealth satellite-predicted asset wealth c d mean r 2 0.50 0.60 0.70 0.75 0.80 0.85 1 na e f r 2: 0.82, 0.89; 0.73, 0.81 r 2: 0.71, 0.83; 0.54, 0.76 weighted; unweighted weighted; unweighted 2 2 census-measured asset wealth census-measured asset wealth 1 1 0 0 –1 –1 –1 0 1 2 –1 0 1 2 survey-measured asset wealth satellite-predicted asset wealth fig."
4,"2 satellite-based predictions explain the majority of variation in survey-based wealth estimates in all countries, and validate well against independent ground measures. a predicted wealth index versus dhs survey-measured wealth index across all locations and survey years; each point is a survey enumeration area (roughly, village) in a given survey-year, with satellite predictions generated by the cnn ms+nl model for each country from a model trained outside that country (predictions from 5-fold cross validation). r2 values in red report goodness-of-ﬁt on pooled observations, whereas values in black are the average of r2 calculated within country-years. b as for a, but indices aggregated to the district level. c average r2 over survey years at the village level, by country. d average r2 over survey years at the district level, by country. e comparison of dhs-based to independent census-based asset wealth at the district level, for available census measures within 4 years of dhs survey. f comparison of asset wealth predicted by the cnn ms+nl model in held-out-countries to the independent census-based asset measures at the district level."
4,"in b, e, and f, r2 is reported both weighted and unweighted by the number of villages contributing to each district-level average."
4,the number of villages is represented by the dot size.
4,4 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications
5,nature communications | https://doi.org/10.1038/s41467-020-16185-w article a 0.67 0.70 b 0.69 0.70 c 0.75 cnn ms + nl 0.66 0.70 0.68 0.7 cnn ms+nl cnn nl 0.7 cnn nl r 2 on held out countries 0.66 0.69 0.67 0.69 cnn ms knn scalar nl 0.65 0.62 0.65 0.66 0.67 cnn ms cnn transfer 0.6 0.56 0.6 0.59 0.59 cnn transfer 0.55 0.15 0.42 0.21 0.41 linear scalar nl 0.5 0 0.2 0.4 0.6 0.8 0 0.2 0.4 0.6 0.8 0 0.2 0.4 0.6 0.8 1 r2 r2 % of data used in training d e 0.7 2 cnn ms+nl cnn nl 0.6 knn observed wealth r 2 on held out countries 1 0.5 cnn ms 0.4 cnn transfer 0 0.3 0.2 linear scalar nl –1 2 r = 0.40 r 2 = 0.32 0.1 0 –1 0 1 2 1 2 3 4 5 6 7 8 9 10 predicted wealth deciles of data used fig.
5,"3 performance by model and across different samples. a predictive performance of satellite predictions trained using 5 different machine learning models; nl nightlights, ms landsat multispectral, and transfer transfer learning on nightlights with rgb landsat imagery."
5,"each grey line indicates the performance (r2) on a held-out country-year, black lines and text show the average across country-years, and red lines and text show the r2 on the pooled sample. b as in a but for evaluation on held-out villages within the same country. c performance by amount of training data used. d performance of cnn ms+nl model in urban versus rural regions in held-out countries."
5,model is trained on all data in training set and then applied separately to either urban or rural clusters in held-out countries.
5,"each dot is an urban (blue) or rural (red) cluster, with densities showing the distribution of predicted (x-axis) and ground-measured (y-axis) wealth index. e performance across the wealth distribution."
5,"experiments were run separately for increasing percentages of the available clusters (e.g., x-axis value of 4 indicates that all clusters below 40th percentile in wealth were included in the test set). patterns (supplementary fig."
5,"aggregating ground- and of the model’s explanatory power, at least in cross section, satellite-based estimates to the district level again leads to appears to be in separating wealthier clusters from poorer clusters substantial performance improvements (fig. 4b), with predictions rather than in separating the poor from the near poor (fig. 3d). of asset wealth changes explaining up to 50% of the ground- performance at the country level (as shown in fig. 2c) is not estimated changes in asset wealth."
5,"improved performance with strongly related to country-level statistics on headcount poverty aggregation is again consistent with errors cancelling when either rates, urbanization, agriculture, or income inequality (supple- the predictions or ground data are averaged."
5,"to our knowledge, mentary fig."
5,"s11), although we do ﬁnd that model performance is these are the ﬁrst known remote-sensing based estimates of local- somewhat worse in settings where within-village variation in level changes in economic outcomes over time across a broad wealth is high."
5,"poorer performance in these settings could be developing country geography, and provide benchmarks for because our model has difﬁculty making accurate predictions in future work. locally heterogeneous environments (a problem likely ampliﬁed by the random noise that has been added to the data; see below), understanding model performance."
5,"while some of the com- or because sample-based estimates from the ground surveys are bined model’s overall performance in spatial prediction derives themselves more likely to be noisy when local variation is high. from distinguishing wealthier urban areas from poorer rural other sources of noise in the ground data (e.g. due to survey areas, the model is still able to distinguish variation in wealth recall bias, sampling variation or geographic inaccuracies) could within either rural or urban areas (fig. 3d)."
5,"in either case, much also worsen model performance."
5,to explore the overall role of nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 5
6,"article nature communications | https://doi.org/10.1038/s41467-020-16185-w a b r 2 = 0.35 r 2 = 0.51, 0.43 2 2 lsms index of differences lsms index of differences 0 0 –2 –2 –2 0 2 –2 0 2 ms predicted index of differences ms predicted index of differences c d 0.0 0.1 0.2 0.3 0.4 0.0 0.1 0.2 0.3 0.4 r2 r2 nl ms msnl fig."
6,4 satellite predictions of ground-measured changes in wealth over time. a performance of satellite-based model trained to predict the index of the change in wealth over time at the village level.
6,the index is computed by ﬁnding the changes in assets at a household level and creating an index of those changes.
6,"plot shows performance of model trained to predict this index of changes at the village level. b same as a, but with observations aggregated to the district level."
6,"dot size represents number of village observations in each district, and r2 is reported both weighted (r2 = 0.51) and unweighted by number of villages. c, d cross-validated r2 of models trained on multispectral (ms, red), nightlights (nl, blue), and both (msnl, green)."
6,"every reported r2 in c, d is unweighted. ground-based error in model performance, we take two suggests that locational noise in ground data is reducing model approaches."
6,"first, we compare both model-based and ground- performance by r2 = 0.07, or roughly the difference between our based measures against an independent measure of asset wealth best and worst performing cnn models (fig."
6,"3). derived from census data in eight countries, with the comparison made at the district level, the lowest level of geographic downstream tasks."
6,to demonstrate the applicability of our identiﬁcation available in public census data.
6,"we ﬁnd that satellite-based estimates to downstream research or policy tasks, ground-based measures are only slightly more correlated with this we consider two use cases."
6,"the ﬁrst is understanding why some independent wealth measure than our model-based estimates, locations are wealthier than others."
6,"here we study associations and both are highly correlated with the independent estimate between wealth and exposure to extreme temperatures, as much (fig. 2e, f)."
6,"this suggests that at least some of the prediction error past work has indicated the wealth-temperature relationship is in our main results derives from noise in the survey data. nonlinear19,20, and because temperature data are readily avail- second, a known source of error in our ground data is the able for all study locations in an independent gridded dataset21. random noise added to village-level geo-coordinates by the survey ground-based survey data indicate a non-linear relationship implementers to protect privacy."
6,"in practice this jitter creates between village-level wealth and maximum temperature in the geographic misalignment between our input imagery and the true warmest month, and out-of-country estimates from cnn-based location of the surveyed villages; our approach is to look at all models recover this relationship very closely (fig. 5a, “meth- pixels in the 6.72 × 6.72 km neighborhood of the provided gps ods”); estimates from simple scalar nightlights models do not. location assuming that the village’s true location falls in this while none of these cross-sectional estimates are well suited for neighborhood (6.72 km is the neighborhood deﬁned by the input causal identiﬁcation of the impact of temperature on wealth19,22, size of of our cnn architecture and the pixel size of our imagery; we view the close match between satellite- and ground-based see “methods”), but much of this information might not be estimates of the temperature-wealth relationship as evidence relevant to the speciﬁc village’s asset wealth."
6,"to understand the that satellite-based estimates can be useful for these types of performance cost of this noise, we iteratively add additional research questions. locational noise to our training data and then re-evaluate model we also use our estimates to evaluate the hypothetical targeting performance on test data which are either also additionally of a social protection program (e.g. a cash transfer), in which all jittered or not."
6,performance degrades with additional jitter villages below some asset level receive the program and villages (supplementary fig.
6,"s12), although much less rapidly when above the threshold do not."
6,targeting on survey-derived asset evaluating on data that have not also been additionally jittered. data is a common approach to program disbursement in this suggests that the true (unobserved) performance of our main developing countries23.
6,"we compare targeting accuracy, deﬁned results is higher than we report, given that we are evaluating on as the percent of villages receiving the correct program, using data that have been jittered."
6,"using these results to extrapolate estimates from different satellite-based models, under the backward to a hypothetical setting of no jitter in training data assumption that survey-based ground data describe the true asset 6 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications"
7,nature communications | https://doi.org/10.1038/s41467-020-16185-w article a b linear scalar nl 1.0 0.0 0.9 −0.2 targeting accuracy cnn transfer cnn ms+nl wealth index knn scalar nl 0.8 −0.4 cnn ms+nl 0.7 cnn transfer −0.6 knn scalar nl 0.6 linear scalar nl −0.8 survey data 0.5 20 25 30 35 40 10th 20th 30th 40th 50th maximum temperature (°c) targeting threshold (percentile) fig.
7,"5 using satellite-based wealth predictions in downstream tasks. a cross-sectional relationship between average maximum temperature and wealth across survey locations, as estimated with survey wealth data (black) and estimates from three satellite-based models."
7,"each line is a bootstrap of the cross-sectional regression (100 bootstraps, sampling villages with replacement)."
7,"best-performing models recover temperature-wealth relationships that are closest to estimates using ground-measured data, and cnn-based models perform much better than scalar nightlights models. b evaluation of a hypothetical targeting program in which all villages below some desired threshold in the asset distribution receive the program (e.g. a cash transfer) and villages above the threshold do not."
7,"we compare targeting accuracy, deﬁned as the percent of villages receiving the correct program, using estimates from the same four satellite-based models as in a, under the assumption that survey-based ground data provide the true asset distribution."
7,"for instance, using ms+nl estimates to allocate a program to households below median wealth yields a targeting accuracy of 81%, versus 75% for cnn transfer and 62% for scalar nl models."
7,"these estimates likely understate true targeting accuracy, given that ground data are themselves measured with some noise. a b nl imagery c nl predictions h d ms imagery e ms predictions f survey wealth g ms+nl predictions wealth index –1.0 –0.5 0.0 0.5 1.0 fig."
7,"6 spatial extent of imagery allows wealth predictions at scale. a satellite-based wealth estimates across nigeria at pixel level. b, d imagery inputs to model over region in southern nigeria depicted in box in a. f ground truth input to model over the same region. c, e, g model predictions with just nightlights (nl) as input, just multispectral (ms) imagery as input, and the concatenated nl and ms features as input."
7,"in this region, the model appears to rely more heavily on ms than nl inputs, ignoring light blooms from gas ﬂares visible in b. h deciles of satellite-based wealth index across nigeria, population weighted using global human settlement layer population raster, and aggregated to local government area level from the database of global administrative areas. distribution."
7,our best performing satellite models again perform not also associated with high wealth (fig. 6b–g).
7,pixels are easily well on this task (fig. 5b).
7,"for instance, using ms+nl estimates aggregated to higher administrative units using existing popula- to allocate a program to households below median wealth yields a tion rasters, and show strong latitudinal gradients of wealth targeting accuracy of 81%, versus 75% for a cnn transfer model across the country (fig. 6h). and 62% for a scalar nightlights model."
7,"importantly, these generating the pixel-level raster involves processing ~9.1 billion estimates likely understate true targeting accuracy given that pixels of daytime and nighttime imagery."
7,"once the pipeline is ground data are themselves measured with some noise. developed, going from these raw imagery inputs to the prediction raster takes <30 h, including 4 h of model training on a nvidia scalability."
7,"to demonstrate the scalability of our overall titan x gpu (excluding hyperparameter search), and roughly approach, we construct a 7.65 km/pixel gridded wealth map of 24 h for imagery processing and raster generation."
7,"by compar- nigeria, africa’s most populous country, for the years 2012–2014 ison, a nationally representative household survey typically takes using our model that combines daytime multispectral and months to years to execute, at an average cost of $1–2 million nighttime imagery (fig."
7,visualizing both inputs and model usd6.
7,"while this comparison does not imply that our approach predictions shows how our model learns to combine the two can replace household surveys, our approach can accelerate inputs, for example ignoring very bright nightlights pixels asso- estimation of local-level wealth in years or in locations where ciated with oil ﬂaring in the southern part of the country that are survey data are unavailable."
7,nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 7
8,article nature communications | https://doi.org/10.1038/s41467-020-16185-w discussion replicating the wealth index in other contexts.
8,"we then create similar asset our satellite-based deep learning approach to measuring asset indices using two separate external data sets: census data from countries whose censuses report asset ownership questions, and data from living standards mea- wealth is both accurate and scalable, and consistent performance on surement study (lsms) conducted by the world bank."
8,"in the publicly available held-out countries suggests that it could be used to generate wealth census data, a 10 percent sample of microdata geolocated to the second adminis- estimates in countries where data are unavailable."
8,"results suggest trative level (roughly, district or county) is available from each country."
8,"we focus that such estimates could be used to help target social programs in on countries with public data who conducted censuses within 4 years of a dhs data poor environments, as well as to understand the determinants survey in our main sample and which had gathered data on assets similar to what was available in dhs."
8,"we found that 8 countries (benin, lesotho, malawi, rwanda, of variation in well-being across the developing world."
8,"sierra leone, senegal, tanzania, and zambia) had all asset variables used in dhs however, while our cnn-based approach outperforms excluding motorbike and rooms per person."
8,"(using dhs data, we ﬁnd that the approaches to poverty prediction that use simpler features com- original index and an index constructed excluding these two variables had an r2 = mon in the literature (e.g. scalar nightlights7), the information the 0.99.)"
8,"our overall census sample yielded a total of 2,157,000 households observed in 656 administrative areas across these eight countries."
8,"cnn is using to make a prediction is less interpretable than these as census data are only georeferenced at second administrative levels, both simpler approaches, perhaps inhibiting adoption by the policy dhs and census datasets are aggregated to the second-level administrative community."
8,a key avenue for future research is in improving the boundaries provided in the census data.
8,"census data is aggregated using census interpretability of deep learning models in this context, and in household weights to construct representative district averages."
8,a raw average across households is used to construct the corresponding dhs value; dhs and developing approaches to navigate this apparent performance- lsms data do not provide household weights that allow construction of sub- interpretability tradeoff. nationally representative estimates.
8,"our deep learning approach is also perhaps best viewed as a we utilized asset wealth data from lsms panel surveys for ﬁve countries way to amplify rather than replace ground-based survey efforts, as (malawi, nigeria, tanzania, ethiopia, and uganda)."
8,"cluster-level gps coordinates are provided, with clusters in urban areas jittered up to 2 km and clusters in rural local training data can often further improve model performance areas jittered up to 10 km."
8,"we are able to measure asset wealth for 9000 households (fig. 3b), and because other key livelihood outcomes often over time in the lsms data (roughly two orders of magnitude less than dhs), measured in surveys—such as how wealth is distributed within distributed over ~1400 clusters."
8,"as lsms data follow households over time, we households, or between households within villages—are more created a village-level panel using only households that existed in the ﬁrst wave of difﬁcult to observe in imagery."
8,"similarly, our approach could also interviews, removing any newly formed households or households that were not in later surveys."
8,"additionally, where available, households that reported in the second be applied to the measurement of other key outcomes, including survey that they had lived in their current location for less time than had elapsed consumption-based poverty metrics or other key livelihood since the ﬁrst survey (i.e. migrant families) were removed."
8,lsms data were indicators such as health outcomes.
8,"performance in these related processed to try to match our dhs index as closely as possible, both by including domains will depend both on the availability and quality of the same assets and by matching asset quality deﬁnitions as similarly as possible."
8,"the fridge and motorbike variables were not available in the lsms data and were training data, which remains limited for key outcomes such as excluded from the lsms wealth index."
8,"using dhs data, we ﬁnd that the original consumption in most geographies."
8,"finally, our approach could index and an index constructed excluding the fridge and motorbike variables were likely be further improved by the incorporation of higher- highly correlated, with an r2 of 0.974."
8,"while we cannot directly compare dhs and resolution optical and radar imagery now becoming available at lsms indices at the village level, district level estimates from the two sources have an r2 of 0.60. near daily frequency (fig. 1b), or in combination with data from while our asset data cannot be used to directly construct poverty estimates— other passive sensors such as mobile phones17 or social media standard poverty measures are constructed from consumption expenditure data, platforms24."
8,all represent scalable opportunities to expand the which are not available in dhs surveys—household consumption aggregates are accuracy and timeliness of data on key economic indicators in the available in a subset of the lsms data just described.
8,"across six surveys in three countries, we ﬁnd our constructed wealth index is fairly strongly correlated with log developing world, and could accelerate progress towards mea- surveyed consumption at the village level, with a weighted r2 of 0.50 (supplementary suring and achieving global development goals."
8,"these results are consistent with ﬁndings that asset indices and consumption metrics are typically very comparable14, and suggest that our approach to wealth prediction could perhaps be useful for consumption prediction as well, particularly as methods additional consumption data become available to train deep learning models."
8,construction of asset wealth index.
8,"the asset wealth index is constructed from responses to the set of questions about asset ownership that are common across dhs countries and waves: number of rooms occupied in a home, if the home has electricity, the quality of house ﬂoors, water supply and toilet, and ownership of a satellite imagery."
8,"we obtained landsat surface reﬂectance and nighttime lights phone, radio, tv, car and motorbike."
8,"variables such as ﬂoor type are converted from (nightlights) images centered on each cluster location, using the landsat archives descriptions of the asset to a 1–5 score indicating the quality of the asset."
8,we then available on google earth engine.
8,"we used 3-year median composite landsat construct an asset index at the household level from the ﬁrst principal component of surface reﬂectance images of the african continent captured by the landsat 5, these survey responses, a standard approach in development economics13,16."
8,"this landsat 7, and landsat 8 satellites."
8,"we chose three 3-year periods for compositing: index is meant to capture household asset ownership as a single dimension, rather 2009–11, 2012–14, and 2015–17."
8,each composite is created by taking the median of than act as a direct measure of poverty.
8,"by construction, the index has a mean equal each cloud free pixel available during that period of 3 years."
8,the motivation for to 0 and standard deviation of 1 across households.
8,supplementary table s4 pro- using three-year composites was two-fold.
8,"first, multi-year median compositing vides derived loadings for the ﬁrst principal component. has seen success in similar applications as a method to gather clear satellite ima- survey data are derived from 43 demographic and health surveys (dhs) gery26, and even in 1-year compositing we continued to note the substantial surveys conducted for 23 countries in africa from 2009 to 2016 (supplementary inﬂuence of clouds in some regions, given imperfections in the cloud mask."
8,"second, table s1)."
8,"in addition to the asset data, each dhs survey contains latitude/ the outcome we are trying to predict (wealth) tends to evolve slowly over time, and longitude coordinates for each survey enumeration area (or cluster) surveyed, each we similarly wanted our inputs to not be distorted by seasonal or short-run var- roughly equivalent to a village in rural areas and a neighborhood in urban areas. iation."
8,"the images have a spatial resolution of 30 m/pixel with seven bands which we removed clusters with invalid gps coordinates and clusters for which we were we refer to as the multispectral (ms) bands: red, green, blue, nir (near unable to obtain satellite imagery, leaving us with 19,669 clusters."
8,"to protect the infrared), swir1 (shortwave infrared 1), swir2 (shortwave infrared 2), and privacy of the surveyed households, dhs randomly displaces the gps coordinates temp1 (thermal). up to 2km for urban clusters and 10km for rural clusters25; this introduces a source for comparability, we also created 3-year median composites for our nightlights of noise in our training data. imagery."
8,"because no single satellite captured nightlights for all of 2009–2016, we used dmsp27 for the 2009–11 composite, and viirs28 for the 2012–14 and 2015–17 composites."
8,dmsp nightlights have 30 arc-second/pixel resolution and validating the wealth index.
8,"the pca-based index is quite robust to methods of are unitless, whereas viirs nightlights have 15 arc-second/pixel resolution and calculation as well as variables included in the index."
8,we compare our cross- units of nwcm−2sr−1.
8,"the images are resized using nearest-neighbor upsampling country pooled pca index to a measure that is the sum of all the assets owned, a to cover the same spatial area as the landsat images."
8,because of the resolution pca constructed from only objects that are owned (e.g.
8,"tv, radio) and not from difference and the incompatibility of their units, we treat the dmsp and viirs housing quality scores which are more subjective, and country-speciﬁc asset indices nightlights as separate image bands in our models. created from running the pca on each country separately."
8,as shown in supple- both ms and nl images were processed in and exported from google earth mentary fig.
8,"s2, correlations between the pooled pca index we use and these engine29 in 255 × 255 tiles, then center-cropped to 224 × 224, the input size of our alternative variants range from r2 = 0.80 to r2 = 0.98."
8,"cnn architecture, spanning 6.72 km on each side (30 m landsat pixel size × 224 8 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications"
9,nature communications | https://doi.org/10.1038/s41467-020-16185-w article px = 6.72 km).
9,note that this means any survey cluster pﬃﬃwhose ﬃ location coordinates 3-class classiﬁcation problem.
9,"with these models trained to predict nightlights values are artiﬁcially displaced by more than 4.75 km (6:72= 2) is completely beyond the from daytime imagery, we froze the model weights and ﬁne-tuned the ﬁnal fully spatial extent of the satellite imagery."
9,each band is normalized to have mean 0 and connected layer to predict the wealth index.
9,we note that our transfer learning standard deviation 1 across our entire dataset.
9,"the raster of wealth in nigeria in experiments contain a much larger set of countries than the jean et al.8 results, which fig. 5 was generated by exporting non-overlapping tiles from google earth engine, focused on ﬁve countries, and thus are not directly comparable. following the same processing steps as for model training."
9,baseline models.
9,we train simpler k-nearest neighbor models (knn) on night- deep learning models.
9,"our deep cnn models use the resnet-18 architecture (v2, lights that predict wealth in a given location i as the average wealth over the k with preactivation)30, chosen for its balance of compactness and high accuracy on locations with nightlights values closest to that in i."
9,"in essence, this model allows a the imagenet image classiﬁcation challenge31."
9,we modify the ﬁrst convolutional non-linear and non-monotonic mapping of nightlights to wealth.
9,"the hyper- layer to accommodate multi-band satellite images, and we modify the ﬁnal layer to parameter k is tuned by cross-validation."
9,we also train a regularized linear output a scalar for regression.
9,"for predicting changes in wealth and the “index of regression on scalar nighlights (scalar nl) as a baseline model. differences” on the lsms data, we stack together the images from two different years to create a 224 × 224 × (2c) image, where c is the number of channels in a training on limited data."
9,"to evaluate how models perform in even more data- single satellite image. limited situations, we trained our deep models on random subsets of 5%, 10%, 25%, the modiﬁcations to the ﬁrst convolutional layer prevent direct initialization from 50%, and 100% of the full training data, repeated over 3 trials with different random weights pre-trained on imagenet."
9,"instead, we adopt the same-scaled initialization subsets."
9,"for each subset size, we report the mean r2 over the three trials (fig. 3c). procedure32: weights for the rgb channels are initialized to values pre-trained on imagenet, whereas weights for the non-rgb channels in the ﬁrst convolutional layer are initialized to the mean of the weights from the rgb channels."
9,then all of these data splits.
9,"for both dhs and lsms survey data, we split the data into 5 folds of weights are scaled by 3/c where c is the number of channels."
9,the remaining layers of roughly equal size for cross-validation.
9,"for the dhs out-of-country tests, we the resnet are initialized to their imagenet values, and the weights for the ﬁnal layer manually split the 23 countries into the 5 folds such that each fold had roughly the are initialized randomly from a standard normal distribution truncated at ±2."
9,"for the same number of villages, ranging from 3909 to 3963 (supplementary table s2)."
9,"as models trained only on the nightlights bands, we initialized the ﬁrst layer weights described below, models were trained using cross-validation to select optimal randomly using he initialization33."
9,when predicting changes in wealth and when hyperparameters.
9,"each model was trained on 3-folds, validated on a 4th, and tested predicting the index of differences on the lsms data, we used random initialization on a 5th."
9,"the fold splits used in the cross-validation procedure are shown in instead, as it performed better than using same-scaled imagenet initialization on the supplementary table s3."
9,"for dhs in-country training, we split the 19,699 villages validation sets (see “cross-validation”). into 5 folds such that there was no overlap in satellite images of the villages the resnet-18 models are trained with the adam optimizer34 and a mean between any fold, where overlap is deﬁned as any area (however small) that is squared-error loss function."
9,the batch size is 64 and the learning rate is decayed by present in both images.
9,we used the dbscan algorithm to group together villages a factor of 0.96 after each epoch.
9,"the models are trained for 150 epochs (200 epochs with overlapping satellite images, sorted the groups by the number of villages per for dhs out-of-country)."
9,"the model with the highest r2 on the validation set across group in decreasing order, then greedily assigned each group to the fold with the all epochs is used as the ﬁnal model for comparison."
9,this is done as a regularization fewest villages.
9,"we followed the same procedure to create 5 lsms in-country folds. technique, equivalent to early-stopping."
9,"we performed a grid search over the we did not perform out-of-country tests with lsms data. learning rate (1e-2, 1e-3, 1e-4, 1e-5) and l2 weight regularization (1e-0, 1e-1, 1e-2, 1e-3) hyperparameters to ﬁnd the model that performs the best on the validation cross-validation."
9,"for each of the input band combinations (ms, ms+nl, nl), we fold."
9,"to prevent overﬁtting, the images are augmented by random horizontal and trained ﬁve separate models, each with a different test fold."
9,of the four remaining vertical ﬂips.
9,"the non-nightlights bands are also subject to random adjustments to folds, three folds were used to train the models, with the ﬁnal fold designated as the brightness (up to 0.5 standard deviation change) and contrast (up to 25% change). validation set used for early stopping and tuning other hyperparameters (supple- additionally, for predicting changes in wealth and the index of differences on the mentary table s3)."
9,"once the cnns were trained, we ﬁne-tuned the last fully lsms data, we randomize the order for stacking the satellite images (i.e. stacking the connected layer using ridge regression with leave-one-group-out cross-validation. before image on top of or below the after image), multiplying the label by −1 in the out-of-country setting, we ﬁne-tuned the ﬁnal layer individually for each test whenever the after image was stacked on top to signify a reversed order. country, using data from all other countries."
9,"thus, the convolutional layers in the when using the two nightlights bands, we set pixels in the non-present band to cnns have effectively seen data from four of the 5-folds, while the ﬁnal layer sees all zeros."
9,this ensures that the ﬁrst-layer weights for that band are not updated data from every country except the test country.
9,"in the in-country setting, we only during back-propagation, because the gradient of the loss with respect to the used data from the non-test folds for ﬁne-tuning. weights for the all-zero band becomes zero."
9,"furthermore, since the resnet-18 ideally, the hyperparameters for machine learning models should be tuned by architecture has a batch-normalization layer following each convolutional layer, cross-validation for optimal generalization performance on unseen data."
9,"however, there are no bias terms. because training deep neural networks requires substantial computational for models incorporating both landsat and nightlights (i.e. our combined resources, leave-one-group-out cross-validation is prohibitively time intensive model), we trained two resnet-18 models separately on the landsat bands and (where in our setting, each group is a country)."
9,"consequently, we performed leave- nightlights bands, respectively, and joined the models in their ﬁnal fully connected one-fold-out cross-validation for all the hyperparameters for the body of the cnn, layer."
9,"in other words, we concatenated the ﬁnal layers of the separate landsat and and only used leave-one-group-out cross-validation to tune the regularization nightlights models and trained a ridge-regression model on top."
9,we found that parameter for training the weights in the ﬁnal fully connected layer. this approach performed better than stacking the nightlights and landsat bands together in a single model.
9,"for dhs data, an average of 25.59 households (standard deviation = 5.59) were comparison with previous benchmarks."
9,"our model achieves a cross-validated surveyed for each village, compared to an average of 6.37 households (sd = 3.57) in r2 = 0.67 on pooled cluster-level observations in held-out countries (or r2 = 0.70 lsms."
9,"due to the lower number of households surveyed for lsms, which results in when averaging over r2 values from each country)."
9,"this meets or exceeds published noisier estimates of village-level wealth, we weighted lsms villages proportional to performance on related tasks, including using high-resolution imagery and transfer their surveyed household count in the loss function during training."
9,"we did not learning to predict asset wealth in ﬁve african countries8 (r2 = 0.56), using call weight dhs villages. detail records to predict asset wealth in rwanda17 (r2 = 0.62), and using survey data and geospatial covariates to predict housing quality5 (r2 = 0.67), child stunting1 (r2 = 0.49), diarrheal incidence2 (r2 = 0.47 averaged over years) across sub-saharan transfer learning models."
9,we compared our end-to-end training procedure with africa or to predict standard of living in senegal18 (r2 = 0.69).
9,all values are for the transfer learning approach ﬁrst proposed by jean et al.8.
9,"in this approach, published cross-validated performance at the cluster or pixel level (except for nightlights are a noisy but globally available proxy for economic activity (r2 ≈ 0.3 diarrheal incidence whose performance is only reported at the admin-2 level). with asset wealth), and a model is trained to predict nighttime lights values from as our primary focus is on constructing and evaluating out-of-country daytime multispectral imagery."
9,"this process summarizes high-dimensional input predictions, our results are not directly comparable to ﬁndings from other small daytime satellite images as lower-dimensional feature vectors than can then be used area estimate approaches that rely on having in-country surveys with which to in a regularized regression to predict wealth. extract covariates and make local-level predictions (e.g. refs."
9,"35,36)."
9,"however, our because our images have a mixture of dmsp and viirs values, and the two satellite-derived wealth estimates and/or the satellite-derived features themselves satellites have different spatial resolutions, the binning approach in jean et al.8 that could be used as input to these small area estimates, and evaluating the utility of treated nightlights prediction as a classiﬁcation problem was unworkable."
9,"instead, we satellite-derived data in such settings is a promising avenue for future research. framed transfer learning as a multitask regression problem."
9,"we extracted the neural network’s ﬁnal layer output predictions for both the dmsp value and the viirs value, and regressed on whichever nightlights label was available for each daytime image."
9,on research and policy experiments.
9,"to study whether our satellite-based estimates the nightlights prediction task over locations sampled from all 23 dmsp countries, can be used to shed light on the determinants of the spatial distribution of wealth— our transfer learning models achieved performance of r2 = 0.82 when using rgb a longstanding research question—we match our ground-based and satellite-based bands and r2 = 0.90 when using all landsat bands; these values are not directly wealth estimates to gridded data on maximum temperature in the warmest comparable to results in jean et al.8, as that work posed nightlights prediction as a month21."
9,we study temperature as our potential wealth determinant because past nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 9
10,"article nature communications | https://doi.org/10.1038/s41467-020-16185-w work has suggested that differences in temperature exert signiﬁcant, non-linear 5."
10,"tusting, l."
10,s. et al.
10,"mapping changes in housing in sub-saharan africa from inﬂuence on economic output19,20, because temperature data are readily available 2000 to 2015."
10,"nature 568, 391–394 (2019). for all our study locations."
10,"espey, j. et al."
10,data for development: a needs assessment for sdg monitoring and we extract the maximum average monthly temperature for each cluster in our statistical capacity development.
10,sustain.
10,solut.
10,netw. http://unsdsn.org/wp- dataset (averaged over the years 1970–200021) and then ﬂexibly regress wealth content/uploads/2015/04/data-for-development-full-report.pdf (2015). estimates on temperature: 7.
10,"henderson, j."
10,"v., storeygard, a."
10,"& weil, d."
10,measuring economic growth wi ¼ f ðt i þ þ εi ð1þ from outer space.
10,"102, 994–1028 (2012)."
10,"jean, n. et al."
10,combining satellite imagery and machine learning to predict where wi is the wealth estimate for cluster i and f(ti) is a fourth-order polynomial in poverty.
10,"science 353, 790–794 (2016). temperature."
10,"to capture uncertainty in our estimates of f(), we bootstrap eq."
10,(1) 100 9.
10,"babenko, b. et al."
10,"poverty mapping using convolutional neural networks times for each different wealth measure, sampling villages with replacement."
10,"we trained on high and medium resolution satellite images, with an application in compare estimates of f() when we measure wi using the ground data or when using mexico. in proc."
10,"nips 2017 workshop on machine learning for the developing various satellite-based estimates: our benchmark ms + nl estimates, or the two world. https://arxiv.org/abs/1711.06323."
10,"(neural information processing main other published approaches, cnn transfer learning8 and scalar nightlights7."
10,"systems foundation, san diego, ca, 2017)."
10,results are shown in fig. 5a.
10,we emphasize that these cross-sectional estimates of 10.
10,"engstrom, r., hersh, j."
10,"& newhouse, d."
10,"poverty from space: using high- f() do not represent causal estimates of the impact of temperature on wealth, as resolution satellite imagery for estimating economic well-being."
10,world bank many other factors are known to be correlated with both temperature and wealth policy res.
10,"1, 1–36 (2017). (e.g. institutional quality, disease environment, nearby trading partners, etc.)"
10,"head, a., manguin, m., tran, n."
10,"& blumenstock, j."
10,"can human to study whether our satellite-based estimates can be used for policy tasks, we development be measured with satellite imagery?"
10,in proc.
10,"ninth international evaluate the hypothetical targeting of a social protection program (e.g. a cash transfer), conference on information and communication technologies and in which all villages below some asset level receive the program and villages above that development, ictd ’17, 8:1–8:11 (acm, new york, 2017). https://dl.acm.org/ level do not."
10,such targeting on survey-derived asset data is a common approach to citation.cfm?
10,doid=3136560.3136576. program disbursement in developing countries23.
10,because asset indices constitute a 12.
10,"watmough, g."
10,r. et al.
10,"socioecologically informed use of remote sensing data relative measure of wealth and it is not obvious how to set an absolute cut-off to deﬁne who is poor, standard practice is instead to divide the population into to predict rural household poverty."
10,natl acad.
10,"usa 116, 1213–1218 percentiles in the asset distribution and then designate bottom percentiles as poor15."
10,(2019).
10,we follow that practice here.
10,"using the ground data, we deﬁne a threshold wp;g 13."
10,"sahn, d."
10,"& stifel, d."
10,exploring alternative measures of welfare in the absence of expenditure data.
10,"income wealth 49, 463–489 (2003). corresponding to a chosen percentile p in the ground-measured asset distribution, 14."
10,"filmer, d."
10,"& scott, k."
10,assessing asset indices.
10,"demography 49, 359–392 (2012). and designate any village with wealth below that threshold as a program beneﬁciary 15."
10,"alkire, s. et al."
10,"multidimensional poverty measurement and analysis (oxford (a treated village), i.e. t i;g;p ¼ 1½wi;g < wp;g , where wi,g is village i’s measured wealth university press, usa, 2015). in the ground data and ti,g,p denotes that villages treatment status according to the 16."
10,"filmer, d."
10,"& pritchett, l."
10,estimating wealth effects without expenditure ground data.
10,"we then follow the same procedure for a satellite-estimated wealth data-or tears: an application to educational enrollments in states of india. distribution s, choosing the same percentile p in the satellite-estimated distribution demography 38, 115–132 (2001). to deﬁne treatment."
10,this yields each village’s treatment status under the satellite- 17.
10,"blumenstock, j., cadamuro, g."
10,"& on, r."
10,predicting poverty and wealth from derived estimates t i;s;p ¼ 1½wi;s < wp;s .
10,we note that we are ﬁxing p between mobile phone metadata.
10,"science 350, 1073–1076 (2015). ground- and satellite-based estimates rather than ﬁxing the wealth threshold, such 18."
10,"pokhriyal, n."
10,"& jacques, d."
10,combining disparate data sources for improved that the same overall number of villages are treated in both the ground-measured poverty prediction and mapping.
10,natl acad.
10,"usa 114, e9783–e9792 case and the satellite-measured case."
10,(2017).
10,"under the assumption that the ground-derived treatment statuses ti,g are 19."
10,"burke, m., hsiang, s."
10,"& miguel, e."
10,"global non-linear effect of temperature correct, we then deﬁne targeting accuracy as,p as the proportion of satellite- on economic production."
10,"nature 527, 235 (2015). derived treatment p statuses that are correct under a given percentile cutoff p, i.e."
10,"nordhaus, w."
10,"geography and macroeconomics: new data and new as;p ¼ n1 ni¼1 1½t i;s;p ¼ t i;g;p , where n is the total number of villages."
10,we compute ﬁndings.
10,natl acad.
10,"usa 103, 3510–3517 (2006)."
10,"as under different values of p ranging from the 10th to the 50th percentile, and for 21."
10,"fick, s."
10,"& hijmans, r."
10,"worldclim 2: new 1-km spatial resolution climate the same three different satellite-based wealth estimates s (ms+nl, transfer surfaces for global land areas."
10,climatol.
10,"37, 4302–4315 (2017). learning, and scalar nl) used in fig."
10,we emphasize that to the extent that the 22.
10,"dell, m., jones, b."
10,"& olken, b."
10,what do we learn from the weather?
10,"the ground data wi,g are measured with noise, which we have strong evidence of (see new climate-economy literature."
10,economic lit.
10,"52, 740–798 (2014)."
10,supplementary fig.
10,"s12 and fig. 2e, f), our estimated targeting accuracy likely 23."
10,"grosh, m."
10,"e., delninno, c., tesliuc, e."
10,"& ouerghi, a."
10,for protection and understates true targeting accuracy.
10,"promotion: the design and implementation of effective safety nets (the world bank, 2008)."
10,reporting summary.
10,further information on research design is available in 24.
10,"sheehan, e. et al."
10,predicting economic development using geolocated the nature research reporting summary linked to this article.
10,wikipedia articles.
10,"in proc. 25th acm sigkdd international conference on knowledge discovery & data mining, 2698–2706 (association for computing data availability machinery, new york, ny, 2019)."
10,data to replicate all ﬁndings in the paper are available at https://github.com/sustainlab- 25.
10,"burgert, c."
10,"r., colston, j., roy, t."
10,"& zachary, b."
10,geographic displacement group/africa_poverty. procedure and georeferenced data release policy for the demographic and health surveys.
10,"(icf international, 2013). http://dhsprogram.com/pubs/pdf/ sar7/sar7.pdf."
10,code availability 26.
10,"azzari, g."
10,"& lobell, d."
10,landsat-based classiﬁcation in the cloud: an code to replicate all ﬁndings in the paper are available at https://github.com/sustainlab- opportunity for a paradigm shift in land cover monitoring.
10,remote sens. group/africa_poverty.
10,environ.
10,"202, 1–11 (2017)."
10,"hsu, f.-c., baugh, k., ghosh, t., zhizhin, m."
10,"& elvidge, c."
10,dmsp-ols received: 22 november 2019; accepted: 8 april 2020; radiance calibrated nighttime lights time series with intercalibration.
10,remote sens.
10,"7, 1855–1876 (2015)."
10,"elvidge, c."
10,"d., baugh, k., zhizhin, m., hsu, f."
10,"& ghosh, t."
10,viirs night-time lights.
10,remote sens.
10,"38, 5860–5879 (2017)."
10,"gorelick, n.et al."
10,"google earth engine: planetary-scale geospatial analysis for everyone. in remote sensing of environment (elsevier, 2017). https://doi.org/ 10.1016/j.rse.2017.06.031."
10,references 30.
10,"he, k., zhang, x., ren, s."
10,"& sun, j."
10,identity mappings in deep residual 1.
10,"osgood-zimmerman, a. et al."
10,"mapping child growth failure in africa between networks. in computer vision—eccv 2016, (eds leibe, b., matas, j., sebe, n. 2000 and 2015."
10,"nature 555, 41 (2018)."
10,"& welling, m.), 630–645 (springer international publishing, 2016). https:// 2."
10,"reiner, r."
10,jr et al.
10,"variation in childhood diarrheal morbidity and mortality doi.org/10.1007/978-3-319-46493-0_38https://arxiv.org/abs/1603.05027. in africa, 2000–2015."
10,"379, 1128–1138 (2018)."
10,"russakovsky, o. et al."
10,imagenet large scale visual recognition challenge.
10,"graetz, n. et al."
10,mapping local variation in educational attainment across computer vis.
10,"115, 211–252 (2015)."
10,africa.
10,"nature 555, 48 (2018)."
10,"perez, a. et al."
10,poverty prediction with public landsat 7 satellite imagery and 4.
10,"burke, m., heft-neal, s."
10,"& bendavid, e."
10,sources of variation in under-5 machine learning. in proc.
10,nips 2017 workshop on machine learning for the mortality across sub-saharan africa: a spatial analysis.
10,lancet glob.
10,"health 4, developing world, (long beach, neural information processing systems e936–e945 (2016)."
10,"foundation, san diego, ca, 2017). http://arxiv.org/abs/1711.03654."
10,10 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications
11,nature communications | https://doi.org/10.1038/s41467-020-16185-w article 33.
11,"he, k., zhang, x., ren, s."
11,"& sun, j."
11,delving deep into rectiﬁers: surpassing human- additional information level performance on imagenet classiﬁcation.
11,in proc.
11,"2015 ieee international supplementary information is available for this paper at https://doi.org/10.1038/s41467- conference on computer vision (iccv), iccv ’15, 1026–1034 (ieee computer 020-16185-w."
11,"society, washington, 2015). https://doi.org/10.1109/iccv.2015.123."
11,"kingma, d."
11,"& ba, j."
11,adam: a method for stochastic optimization. arxiv.
11,correspondence and requests for materials should be addressed to m.b.
11,preprint at http://arxiv.org/abs/1412.6980 (2014).
11,"molina, i., nandram, b."
11,"& rao, j. et al."
11,"small area estimation of general peer review information nature communications thanks gary richard watmough and parameters with application to poverty indicators: a hierarchical bayes the other, anonymous, reviewer(s) for their contribution to the peer review of this work. approach."
11,"8, 852–885 (2014)."
11,peer reviewer reports are available.
11,"elbers, c., lanjouw, j."
11,"& lanjouw, p."
11,micro-level estimation of poverty and inequality.
11,"econometrica 71, 355–364 (2003)."
11,reprints and permission information is available at http://www.nature.com/reprints publisher’s note springer nature remains neutral with regard to jurisdictional claims in acknowledgements published maps and institutional afﬁliations.
11,we thank usaid bureau for food security and the stanford king center on global development for funding support.
11,ermon acknowledges national science foundation grants #1651565 and #1522054 for additional support.
11,"open access this article is licensed under a creative commons attribution 4.0 international license, which permits use, sharing, author contributions adaptation, distribution and reproduction in any medium or format, as long as you give m.b., s.e., and d.l. conceived of the study."
11,"g.a. and z.t. processed and analyzed satellite appropriate credit to the original author(s) and the source, provide a link to the creative imagery."
11,a.d. processed and analyzed survey and census data.
11,"c.y. and a.p. trained deep commons license, and indicate if changes were made."
11,the images or other third party learning models and analyzed their output with a.d. and m.b.
11,"c.y., a.p., a.d., d.l., s.e., material in this article are included in the article’s creative commons license, unless and m.b. interpreted results of model experiments."
11,a.p. and c.y. generated the wealth indicated otherwise in a credit line to the material.
11,if material is not included in the raster.
11,"c.y., a.p., a.d., s.e., d.l., and m.b. wrote the paper. article’s creative commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder."
11,"to view a copy of this license, visit http://creativecommons.org/ competing interests licenses/by/4.0/."
11,"m.b., d.l., and s.e. are co-founders of atlasai, a company that uses machine learning to measure economic outcomes in the developing world."
11,"a.p. and g.a. conducted the research for this paper while students or employees at stanford, but are also now employed at atlasai."
11,© the author(s) 2020 nature communications | (2020)11:2583 | https://doi.org/10.1038/s41467-020-16185-w | www.nature.com/naturecommunications 11
