page,p
1,sensors article demonstration of a modular prototype end-to-end simulator for aquatic remote sensing applications mark w.
1,"matthews 1 , arnold dekker 2,3, * , ian price 4 , nathan drayson 5 , joshua pease 6 , david antoine 7 , janet anstee 5 , robert sharp 4 , william woodgate 8 , stuart phinn 8 and stephen gensemer 6 1 cyanolakes (pty) ltd., sydney, nsw 2126, australia; mark@cyanolakes.com 2 satdek (pty) ltd., sutton, nsw 2620, australia 3 csiro space and astronomy, canberra, act 2601, australia 4 research school of astronomy and astrophysics, college of science, australian national university, canberra, act 2601, australia 5 csiro environment, canberra, act 2601, australia 6 csiro manufacturing, melbourne, vic 3216, australia 7 remote sensing and satellite research group, school of earth and planetary sciences, curtin university, perth, wa 6845, australia 8 school of the environment, the university of queensland, st lucia campus, st lucia, qld 4067, australia * correspondence: arnoldgdekker@gmail.com abstract: this study introduces a prototype end-to-end simulator software tool for simulating two- dimensional satellite multispectral imagery for a variety of satellite instrument models in aquatic environments."
1,"using case studies, the impact of variable sensor configurations on the performance of value-added products for challenging applications, such as coral reefs and cyanobacterial algal blooms, is assessed."
1,"this demonstrates how decisions regarding satellite sensor design, driven by cost constraints, directly influence the quality of value-added remote sensing products."
1,"furthermore, the simulator is used to identify situations where retrieval algorithms require further parameterization before application to unsimulated satellite data, where error sources cannot always be identified or isolated."
1,"the application of the simulator can verify whether a given instrument design meets the citation: matthews, m.w."
1,"; dekker, performance requirements of end-users before build and launch, critically allowing for the justification a."
1,"; price, i."
1,"; drayson, n."
1,"; pease, j.; of the cost and specifications for planned and future sensors."
1,"it is hoped that the simulator will antoine, d."
1,"; anstee, j."
1,"; sharp, r.; enable engineers and scientists to understand important design trade-offs in phase 0/a studies easily, woodgate, w."
1,"; phinn, s.; et al. quickly, reliably, and accurately in future earth observation satellites and systems."
1,demonstration of a modular prototype end-to-end simulator for keywords: end-to-end simulator; optical sensors; design; remote sensing; optics; satellite; smallsat; aquatic remote sensing cubesat; coral reefs; cyanobacterial blooms; bathymetry applications.
1,"sensors 2023, 23, 7824. https://doi.org/10.3390/s23187824 academic editor: robert knuteson 1."
1,"introduction received: 5 july 2023 revised: 30 august 2023 aquawatch australia is a mission of the commonwealth science and industrial accepted: 7 september 2023 research organisation (csiro, australia’s national science agency) to build an integrated, published: 12 september 2023 operational system combining in situ and earth observation data for monitoring and managing australia’s inland and coastal water bodies."
1,the aquawatch concurrent design facility study [1] identified the need for an end-to-end simulator that could assess trade-offs in satellite instrument design in early phase 0/a studies.
1,"this led to the present study called copyright: © 2023 by the authors. the “aquawatch pathfinders: earth observation (eo) sensor design simulator testbed licensee mdpi, basel, switzerland."
1,(end-to-end simulator)”.
1,a virtual testbed in the form of an end-to-end simulation tool is this article is an open access article an essential component of the design process of any new earth imaging system [2–6].
1,"the distributed under the terms and development of new optical satellite sensors requires multiple trade-offs between cost and conditions of the creative commons sensor specifications, including the ground sampling distance (gsd); the number, width, attribution (cc by) license (https:// and position of spectral bands; swath width and the instantaneous field of view; temporal creativecommons.org/licenses/by/ resolution (revisit time); and radiometric sensitivity."
1,new sensors must demonstrate that 4.0/).
1,"sensors 2023, 23, 7824. https://doi.org/10.3390/s23187824 https://www.mdpi.com/journal/sensors"
2,"sensors 2023, 23, 7824 2 of 14 they meet or exceed the minimum requirements for a given application, and the impact of any sensor design trade-off on the quality of the final value-added product should be clearly demonstrated to assess the benefits of costly design decisions."
2,having a tool that can simulate how sensor design trade-offs impact the final product quality will enhance the efficient and cost-effective design of future sensors.
2,"sensor design trade-offs are usually assessed by using airborne or in situ remote sensing data [7], which are processed using an instrument model or from highly specialized end-to-end simulators [8–12]."
2,having a sensor-agnostic or sensor-flexible simulator tool minimizes the need to collect airborne data and allows for greater flexibility in exploring various applications.
2,"an end-to-end simulator must capture the entire process of satellite observation, in- cluding the forward (observation using the sensor) and inverse (producing value-added products from the sensor) components (figure 1)."
2,"briefly, the forward component incor- porates the simulation of water-leaving radiance, propagation through the atmosphere, and the sampling of a scene using a sensor model to produce sensor images of raw un- calibrated radiance."
2,"the sensor model sampling the scene (across the track and along the track) incorporates the spatial, spectral, and radiometric characteristics of the sensor."
2,"the inverse problem includes the calibration of at-sensor radiances (so-called level 1 pro- cessing), georeferencing, atmospheric correction to produce remote sensing reflectance 15 sensors 2023, 23, x for peer review(r ) (see appendix a for definition) values, and the application of algorithms 3toofproduce rs quantitative geophysical value-added products (level 2 processing)."
2,flowchart figure1.1.
2,"flowchart figure showing showing thethe modular modular components components ofsimulator, of the the simulator, and forward and forward and inverse and inverse processes."
2,toa = top of the atmosphere.
2,inherent optical properties (iops) refer to the absorption processes.
2,toa = top of the atmosphere.
2,"inherent optical properties (iops) refer to the absorption (a), (a), scattering(b), scattering (b),and backscattering (b andbackscattering (bbb) )volume volumecoeﬃcients. specific thethe coefficients."
2,"(siops) iopsiops specific refer to (siops) iops refer to iops normalized by the concentration of a parameter, such as chl-a. normalized by the concentration of a parameter, such as chl-a."
2,materials and methods 2.1.
2,simulator description 2.1.1.
2,"architecture and scene construction the prototype simulator supports a set of instrument types, each with a suite of"
3,"sensors 2023, 23, 7824 3 of 14 this study presents the initial results from a modular prototype end-to-end sim- ulator (the simulator) similar to the models in [5,8,12], which have been designed for and applied to water applications."
3,"as aquatic applications have more demanding instru- ment requirements than typical vegetation applications (e.g., higher signal-to-noise ratio, narrow spectral bands) [13,14], design decisions have greater consequences for product quality [2,5,12]."
3,the simulator can simulate two-dimensional images for various satellite instrument model configurations using simulated input radiance data from synthetically constructed scenes to investigate the impact on value-added products.
3,"using the output from in-water simulations as input data to the simulator, the effect of sensor configuration on value-added products (e.g., chlorophyll-a (chl-a); water depth (bathymetry); and sub- strate type, which refers to the type of material on the bottom of the lake or ocean floor such as sand, coral, or seagrass) can be directly assessed."
3,"similarly, differences in water quality information products due to the application of a range of retrieval algorithms can also be determined."
3,"several case studies are presented, along with a simplified trade-off study, to demonstrate the utility of the prototype simulator as an instrument design tool for examining trade-offs in instrument specification and instrument performance for a variety of water-related applications."
3,"this study explores the resulting differences in product quality for cubesat versus smallsat class instruments (e.g., [15–17]), thereby enabling a quantitative assessment of the impact of design decisions on downstream applications."
3,materials and methods 2.1.
3,simulator description 2.1.1.
3,"architecture and scene construction the prototype simulator supports a set of instrument types, each with a suite of instrument parameters that may be set by the user."
3,this is the basis for exploring various satellite instrument designs.
3,the instrument samples the radiance field at the top of the atmosphere as it transits a region of earth’s surface and generates the corresponding level-0 data (uncalibrated digital numbers).
3,the radiance across the region is constructed from 2d geospatial maps and 1d hemispherical radiance fields.
3,this leverages 1d radiative transfer simulations to provide a pseudo-3d description of spatially varying toa radiance over large regions.
3,"the instrument samples this region on demand, based on the position and orientation of the instrument as it orbits earth."
3,the pseudo-3d structure is defined as a “scene”.
3,"it is a flexible model that can describe spatially varying spectral radiance over large areas with a very small quantity of input data, but the inherent flexibility demands complex sensors 2023, 23, x for peer review 4 of 15 structures to define the input."
3,the goal of the scene is to allow the user to construct models that represent realistic scenarios that an actual satellite-borne instrument would observe.
3,a library of 1d radiative radiative provides aprovides transfer simulations transfer simulations a multidimensional multidimensional parametric parametric space space for(figure 2). for reflectance reflectance (figure 2).
3,figure2.2.
3,schematic figure schematicrepresentation of the representation ofstructure of a scene the structure of a for a shallow scene aquatic environment. for a shallow aquatic environment.
3,cdom = colored dissolved organic matter.
3,cdom = colored dissolved organic matter.
3,spatial maps describe the variation in reflectance at earth’s surface.
3,a scene description file merges all of this information into a structure that allows the spectral radiance in any direction at any location to be extracted.
3,"with this scene description language, the user can construct a model of the reflectance with a variation that is"
4,figure 2.
4,schematic representation of the structure of a scene for a shallow aquatic environment.
4,cdom = colored dissolved organic matter.
4,"sensors 2023, 23, 7824 4 of 14 spatial maps describe the variation in reflectance at earth’s surface."
4,a scene description file merges all of this information into a structure that allows the spectral spatial radiance in maps describe at any direction variation theany in reflectance location at earth’s to be extracted.
4,withsurface.
4,"a scene this scene descrip- description tion file merges all of this information into a structure that allows the language, the user can construct a model of the reflectance with a variation that is spectral radiance in any direction applicable at any to that location to(e.g., environment figure 3)."
4,with be extracted.
4,"thethis scene description simulator translates language, this human- the user can construct a model of the reflectance with a variation that is applicable readable description into a software object representing the entire scene and allows the to that environmentto(e.g., instrument the3)."
4,figure sample the on scene simulator demand. translates this human-readable the spatial description and into units in scene construction a software object representing the entire scene and allows the instrument sampling are arbitrary and therefore may not represent feature sizes in nature.
4,the to sample the scene onmotion relative demand.
4,the of the units spatialand satellite theinoptical configurationand scene construction sampling determine are arbitrary precisely whereand the therefore may not represent feature sizes in nature.
4,the relative motion of the scene is sampled and the direction of the radiance incident on the sensor elements within satellite and optical configuration determine precisely where the scene is sampled and the direction the instrument. the of the radiance incident on the sensor elements within the instrument.
4,figure 3.
4,scene construction for a synthetic coral reef: (a) water depth in meters; (b) fractional cover of seagrass in percent; (c) fractional coverage of rock in percent; (d) fractional coverage of sand in percent.
4,scene units are arbitrary.
4,2.1.2.
4,instrument models and calibration the simulator has instrument models for different types of instruments implemented in the code.
4,these software models translate spectral radiance at the entrance pupil of the instrument through to the raw digital sample of the imaging array sensor.
4,"the instrument models are parametric, allowing a wealth of physical properties to be specified, and the simulator extracts them from text values in a user-supplied input file."
4,this allows the effects of instrument design changes to be explored.
4,"properties common to many instruments include optical aperture size, sensor pixel size, sensor read noise, sensor pixel well depth, sensor gain, optical spectral transmission efficiency functions, sensor quantum efficiency function, analog to digital converter bits-per-pixel, and amplifier bias level."
4,"one of the instrument models is based on a long-slit spectrograph with an internal dispersive optical element, such as a prism or diffraction grating, analogous to the pathfinder “compact hyperspectral imager for the coastal ocean” or “chico” (australian national university)."
4,"another is based on direct imaging with a gradient index filter, similar to the pathfinder “cyanosat” (csiro) [18]."
4,"in each case, the software models the overall effect of the optical train, not the individual optical elements."
4,"the simulator incorporates two idealized instrument models: one long-slit spectro- graph that functions as an ideal radiometer in every sensor pixel, and a second multispectral instrument with user-defined band-pass filters."
4,"this allows for comparisons with the spec- tral band configurations of other satellite sensors, such as the sentinel-2 multispectral"
5,"sensors 2023, 23, 7824 5 of 14 imager [19] and the sentinel-3 ocean and land color instrument (olci) [20]."
5,"however, the configuration is not necessarily something that could be physically realized."
5,modeling the characteristics of imaging sensors is common to most of these specification instruments.
5,"the simulator is designed for extension, by software development in an object-oriented paradigm, to include more instrument models."
5,"it is anticipated that as an instrument design matures, a more elaborate software model will be developed."
5,one of the existing instru- ment models would likely provide the starting point.
5,"although a ray-tracing approach would be possible, it is not what is intended."
5,decomposing the transformation into a series of steps and incorporating additional models of the physical processes at the intermediate steps is more appropriate.
5,the objective of the simulator is to provide realistic raw data so that the consequences of design decisions can be explored.
5,the calibration of raw data is a critical part of this assessment.
5,the simulator essentially generates level-0 data products (uncalibrated digital numbers).
5,it can also be used to produce the auxiliary data needed to calibrate the instrument.
5,a utility program was developed to preprocess calibration data and transform level-0 products to level-1 products (calibrated radiances).
5,"this transformation results in a measure of the toa radiance (ltoa ), incorporating the effects of instrument noise in the raw data and calibration data."
5,it allows the consequences of both random and systematic errors in calibrating the instrument to be explored (see appendix a for details on calibration).
5,demonstration of the simulator 2.2.1.
5,case studies input datasets were generated for four applications: the surveillance of cyanobacterial blooms in small freshwater reservoirs; the mapping of shallow coral reefs; monitoring turbidity in aquaculture operations in shallow coastal waters; and monitoring chl-a and cdom in reservoirs for drinking water supply.
5,"here, we present two of these case studies."
5,"the first case study is of a hypothetical cyanobacterial bloom representative of lake hume, a large drinking and agricultural water reservoir located in southeastern australia [21]."
5,the iops and rrs at lake hume have been characterized by previous field measurements [22].
5,"here, we demonstrate the retrieval of chl-a pigment."
5,this case study was also used to assess the trade-off between the smallsat and cubesat class instruments.
5,the second case study represents idealized shallow-water seagrass mapping at heron island based on a spectral library of substratum reflectance features from seagrass and corals that have been measured at the site [23].
5,"for this case, the signal from the water column was removed as noise to determine the fractional composition of the substrate (ocean floor), as well as chl-a and water depth."
5,2.2.2.
5,input datasets and scene generation forward radiative transfer models capable of modeling the light field are required to generate the input data required by the simulator to construct a hypothetical scene that is sampled using a given instrument model.
5,the radiative transfer code selected for this study was the open source ocean successive orders with atmosphere—advanced (osoaa) [24].
5,"coupled water–atmosphere radiative transfer simulations with osoaa were used to determine ltoa , path radiances (lpath ), upward atmospheric transmittance (tup ), and surface irradiances (ed 0) for a range of water and atmosphere conditions for the relevant wavelengths and geometries."
5,"the heron island scene was modeled as optically shallow with a single set of siops, while the water depth varied between one and seven meters with three bottom types: coral, sand, and seagrass."
5,bottom reflectance data and siops collected from heron island in 2018 were used [23].
5,the hypothetical lake hume scene was constructed from ltoa modeled using a single set of siops with variable chl-a concentrations (1 to 100 µg/l).
5,"in both cases, an aerosol model was selected for the atmosphere (maritime model for heron island and continental for lake hume) [25]."
5,an aerosol optical thickness of 0.1 at 550 nm was chosen.
6,"sensors 2023, 23, 7824 6 of 14 a gaussian random field generator [26] was used to represent the distribution of chl-a concentrations in a 3000 × 2000 array."
6,"for further details, see appendix b."
6,2.2.3.
6,hypothetical satellite instruments a generic multispectral sensor was specified with a nominal aperture size of 120 mm and spectral bands based on olci.
6,olci bands were used because they are ideally po- sitioned for water applications and readily allow for the application of existing algo- rithms [20].
6,"for this simplified design trade-off study, we considered two additional hypothetical instrument configurations: 1."
6,"a “cubesat” class instrument with a 60 mm, f#-2.75 telescope utilizing a small-pixel focal-plane array; 2."
6,a “smallsat” class instrument with a 240 mm f#-1.80 telescope utilizing a large-pixel focal-plane array with an increased full-well capacity and gain.
6,a full list of instrument design parameters is given in table 1.
6,"to avoid adding unnec- essary complexity to the results, the spectral band configuration and response functions of olci were used."
6,"to avoid complexity, the sampling resolution and spectral configura- tion were held constant, and only differences in instrument noise resulting from different aperture configurations were explored."
6,table 1.
6,configurations of hypothetical sensor instruments.
6,"feature nominal cubesat smallsat altitude (km) 560 560 560 instrument geometry orbital heading azimuth 0.0 0.0 0.0 polarimeter none none none aperture size 120 mm 60 mm 240 mm pixel size 5.5 µm 5.86 µm 15.5 µm focal length 165 mm 165 mm 432 mm number of sensors 1024 1024 1024 exposure time 0.0015 s 0.0015 s 0.0015 s number of exposures 1536 2000 2000 forward tilt angle 0 0 0 read noise 15.0 e 15.0 e 15.0 e instrument design pixel well depth 80,000 e 80,000 e 640,000 e gain 3.0 e/adu 3.0 e/adu 10 e/adu bias 10.4 10.4 10.4 bits 16 16 16 optical transmission 0.885 0.885 0.885 number of bands 19 19 19 400, 411.8, 442.9, 490.5, 510.5, 560.5, 620.4, centre wavelengths (nm) 665.3, 674, 681.6, 709.1, 754.2, 761.7, 764.8, 767.9, 779.2, 865.4, 884.3, 897.4 sampling resolution 20 spectral response function sentinel 3a olci 2.2.4."
6,inversion and validation toa radiances obtained as output from the calibration of the instrument model were atmospherically corrected to determine rrs using ancillary data products generated from the radiative transfer simulations used as input to the instrument model (see appendix a
7,"sensors 2023, 23, 7824 7 of 14 for details)."
7,the aim of this exact atmospheric correction was not to test the performance of any specific algorithm but rather to assess the differences in product quality introduced solely from variable instrument design configurations.
7,"for the heron island case, the sam- buca (semi-analytical model for bathymetry, unmixing, and concentration assessment) algorithm [27] was used to estimate water depth, as well as the bottom type from the atmospherically corrected scenes."
7,"sambuca simultaneously retrieves the concentration of chl-a and non-algal particles (naps), the absorption by colored dissolved organic matter (acdom ), the percent substratum (bottom) cover, and uncertainty estimates via a substrate detectability index."
7,"sambuca was parameterized using the same dataset used to produce the input dataset, including siops and benthic spectra for acropora sp. coal, coralline sand, and turf algae commonly found at heron island."
7,"the advanced linear matrix inversion (almi) [28] was used to estimate chl-a, naps, and acdom from the rrs scenes for the lake hume case."
7,"then, almi was parameterized with the same data used to produce the input datasets and provided with a set of eight averaged siop sets that capture the range of variability in naps and cdom based on in situ measurements at lake hume."
7,"again, the aim was not to assess the performance of different algorithms but rather to examine how variable instrument design and algorithm retrieval affected product quality."
7,"performance of value-added product retrievals using sambuca and almi were evaluated with mean absolute error (mae) and bias calculated in log space after [29]: ∑in=1 |log10 ( mi −log10 (oi )| ( ) mae = 10ˆ n (1) ∑in=1 log10 ( mi −log10 (oi ) ( ) bias = 10ˆ n (2) where m, o, and n are the modeled, observed value, and the sample size, respectively."
7,results 3.1.
7,water depth and chl-a retrieval applications the inputs and outputs for water depth and chl-a value-added products for the hypothetical heron island and lake hume and scenes for a generic multispectral satellite instrument are shown in figure 4.
7,"the output scenes show the introduction of noise from the instrument model, as well as uncertainties introduced through the applications of retrieval algorithms."
7,"this demonstrates the process of observing a target using a satellite sensor, which inherently introduces random noise that affects the overall quality of parameter retrievals."
7,"this is especially evident in the depth map retrieved using sambuca, which shows patches of deep water retrieved using the model that are not present in the input data."
7,"these erroneous depths were highly correlated with incorrect acropora sp. coral substrate identifications, which correlated to the location of seagrass in the input scenes."
7,it is evident that the substrate type selected for algorithm parameterization contributed to erroneous depth estimations.
7,"this demonstrates how the simulator can be used to identify cases where algorithms require further training or more representative parameterization before they are applied to unsimulated satellite data, where error sources cannot always be identified or constrained."
7,a comparison of pixel-for-pixel chl-a and depth retrievals (figure 5) validates the parameter retrievals from the algorithms against the original simulated inputs.
7,this quantitatively demonstrates how the noise introduced through instrument sampling and inversion process affects parameter retrieval performance.
7,"for complex water cases (such as the heron island case explored here) and complex products (such as substrate type), there will always be some discrepancy between inputs and outputs."
7,"in this case, the simulator provides engineers and scientists with quantitative (best) performance estimates that arise solely from instrument noise and retrieval algorithms, enabling the quantification of these effects before satellites are built or launched."
7,based on the satellite algorithm
8,"sensors 2023, 23, 7824 8 of 14 configurations presented here, the best-case mae for chl-a and water depth estimates over complex cyanobacterial bloom and reef systems was 14% and 87%, respectively."
8,"while over- and underestimations were evenly balanced for chl-a, depth was strongly overestimated sensors sensors 2023, 23, x for peer2023, 23, x for review peer review in regions dominated by seagrass."
8,"this highlights how the simulator can be9 used of 15 to 9 assess trade-offs in instrument design that lead to better or worse product outcomes, as demonstrated in the next section."
8,comparison figure4.4.
8,comparison figure between figure between the the input 4.
8,comparison input scene scene between and and thethethe simulated simulated input output output scene and the for for a generic a generic simulated output multispectral multispectral for a generic multispe sensor:(a) sensor: (a)input sensor: (a) input chl-a map; (b) output chl-a map estimated using the almiinput chl-a inputchl-a map; map; (b) (b) output output chl-a chl-a map map estimated estimated using using thethe almialmi algorithm; algorithm; (c) (c) input depth(c) input d depth algorithm; map;(d) map; (d)estimated estimated map;depth depth usingthe (d)using estimatedthesambuca sambuca depth using algorithm. algorithm. the scene sambuca scene units units areare algorithm. arbitrary. arbitrary.
8,scene units are arbitrary.
8,comparisonbetween figure5.5.
8,comparison figure betweenthe the actual actual parameter parameter values values andand those those estimated using estimated the output figure 5.
8,comparison between the actual parameter values andusing thosethe output estimated using the ou from a simulated sensor: from a simulated from sensor: (a) chl-a (a) chl-a for for the the lake lake hume humeforscenescene estimated estimated using the almi algorithm; a simulated sensor: (a) chl-a the lake scenethe humeusing almi algorithm; estimated using the(b)almi algorithm (b) depth depth for heron for the heron the depth island island for scene scene the estimated heron estimated islandusingusing scene the the sambuca sambuca estimated using algorithm. algorithm. the colors colors sambuca in indicate in (b) (b) indicate algorithm.
8,colors in (b) ind thefraction the fractionofofthe thecoral coralacropora acroporasp. in sp. inwhich which substrate type substrate influenced type influencedthe estimation the of estimation the fraction of the coral acropora sp. in which substrate type influenced thedepth. depth. of estimation of depth 3.2.
8,smallsat 3.2.
8,"cubesat versus cubesat trade-oﬀ demonstration versus smallsat trade-oﬀ demonstration the eﬀect of instrument the eﬀectaperture vs. 240 mm, size (60aperture of instrument cubesat size (60 versus vs."
8,"240 smallsat)versus on mm, cubesat smallsa the retrieval quality of chl-a concentration for the synthetic lake hume cyanobacterial the retrieval quality of chl-a concentration for the synthetic lake hume cyanobact bloom case is shown in figures 6 and 7."
8,the results show the quantitative diﬀerences in
9,"sensors 2023, 23, x for peer review sensors 2023, 23, 7824 9 of 14 cubesatperformance product 3.2. versus smallsat that be expected between a cubesat and smallsat candemonstration trade-off the effect the instrument. smalleraperture of instrument aperture sizesize results (60 vs. 240 mm,in cubesat increased image versus speckling smallsat) on the and ov retrieval quality of chl-a underestimation forconcentration chl-a (visible in synthetic for the figure 6lake morecyanobacterial buthume clearly seen bloom in figure case is shown in figures 6 and 7."
9,the results show the quantitative imager with the larger aperture resulted in a value-added product with sign differences in product performance that can be expected between a cubesat and smallsat satellite instrument.
9,"the higher definition, less speckling, and smaller errors than the smaller c smaller aperture size results in increased image speckling and over- and underestimation configuration. for chl-a (visible in figure figure7 6indicates but more the significant clearly influence seen in figure 7)."
9,"the that instrument with the design imager inversion performance and product accuracy—the only diﬀerence in this larger aperture resulted in a value-added product with significantly higher definition, lesscase bei speckling, the instrumentand smaller errors than aperture size the as smaller cubesat configuration. the algorithms were identical.figurealmi 7 indicates retrievals f the significant influence that instrument design had on inversion performance and product cubesat imager required a greater number of siop sets to find a solution (all ei accuracy—the only difference in this case being from the instrument aperture size as the were used) algorithms than were the retrievals identical. using from almi retrievals the cubesatsmallsat the simulated imagea (only greaterthree si imager required were required number of siop sets fortothefindsmallsat a solution image)."
9,"given (all eight sets werethat a than single used) the siop setusing retrievals was used i the simulated smallsat image (only three siop sets were required creation, this indicates that the poorer optical performance of the cubesat image for the smallsat image)."
9,"given that a single siop set was used in scene creation, this indicates that the poorer inappropriate siop selection, which contributed to poor inversion perfo optical performance of the cubesat imager led to inappropriate siop selection, which furthermore, contributed to poor12,748 fewer inversion pixels were performance. returned12,748 furthermore, by almi usingwere fewer pixels the returned cubesat imag lower by almireturn using the rate indicates cubesat imager. that lowerpixels thissome could return rate not be indicates thataccurately some pixels evaluated could u model not and were be accurately therefore evaluated using discarded. the model and the werealmi retrievals therefore from discarded."
9,the the almilarger a smallsat imager had lower mae for chl-a (11%) and narrower retrievaland retrievals from the larger aperture smallsat imager had lower mae for chl-a (11%) distribut narrower retrieval distributions for nap concentration.
9,"in both cases, the retrieval of nap concentration."
9,"in both cases, the retrieval of cdom absorption was poor; h cdom absorption was poor; however, this was expected in the case of the simulated this was expected high-biomass case of the simulated high-biomass cyanobacterial bloom in the bloom. cyanobacterial figure 6."
9,chl-a maps for cubesat and smallsat instrument configurations estimated using the almi figure 6.
9,chl-a maps for cubesat and smallsat instrument configurations estimated using algorithm for a lake hume scene: (a) actual chl-a; (b) chl-a estimated based on a simulated cubesat; algorithm for a lake hume scene: (a) actual chl-a; (b) chl-a estimated based on a simulated (c) actual chl-a; (d) chl-a estimated based on a simulated smallsat.
9,scene units are arbitrary. (c) actual chl-a; (d) chl-a estimated based on a simulated smallsat.
9,scene units are arbitrary
10,"sensors 2023, sensors 23, x7824 2023, 23, for peer review 14 1110ofof 15 figure 7."
10,figure comparisonofofproduct 7.
10,comparison productretrieval performance retrieval for simulated performance cubesat for simulated and smallsat cubesat instru- and smallsat instrument configurations.
10,the colored legend shows diﬀerent siop sets selected when ment configurations.
10,the colored legend shows different siop sets selected when solving using the solving almi the using almi algorithm. algorithm.
10,the dottedthe dotted line on theline on the histograms histograms shows the actualthe shows actual constant constant values: values: (a) (a) cubesat cubesat chl-a; (b) cubesat nap; (c) cubesat cdom; (d) smallsat chl-a; (e) smallsat chl-a; (b) cubesat nap; (c) cubesat cdom; (d) smallsat chl-a; (e) smallsat nap; (f) smallsat cdom.
10,nap; (f) smallsat cdom.
10,discussion 4.
10,"discussion this study demonstrates a prototype end-to-end simulator for informing satellite instrument design this study for aquatic applications. demonstrates this includes a prototype end-to-end water and simulator foratmosphere informing forward satellite models to generate instrument design forinput software thatthis data,applications. aquatic enables hypothetical includes water and scene creation and atmosphere sam- forward pling using an instrument model, and the inversion process used models to generate input data, software that enables hypothetical scene creation and to create and validate value-added sampling products using from rawmodel, an instrument and the data from the top of the atmosphere. inversion process usedthis simplified to create and design trade-off validate study products value-added demonstratesfromhow data decisions, rawdesign from the top directly driven of the by cost-related atmosphere."
10,"this directly constraints,design simplified influence trade-oﬀ product study resolutionhow demonstrates and design quality.decisions, simulator thus, the directly is a suit- driven by able tool for investigating cost-related constraints, directly investment return oninfluence and user product requirements resolution in terms of and quality. product thus, the performance simulator suitablerequiring is awithout the collectionreturn tool for investigating of airborne datasets [5]. on investment andthe consequences user requirements of design decisions can be thoroughly assessed before instruments are built in terms of product performance without requiring the collection of airborne datasets [5]. and launched."
10,"in addition, the the simulator consequences identified of design specific decisions can cases where algorithm be thoroughly assessedretrieval was inaccurate, before instruments are enabling algorithms to be fine-tuned and parameterized to improve built and launched."
10,"in addition, the simulator identified specific cases where algorithmperformance before application retrieval was unsimulated oninaccurate, satellite algorithms enabling data, where to be sources error andalways cannot fine-tuned be identified parameterized to or constrained [10]."
10,"the simple instrument trade-off example demonstrates improve performance before application on unsimulated satellite data, where error the differences be expected that can cannot sources alwaysin end-user product be identified quality resulting or constrained fromsimple [10]."
10,the instrument design trade-oﬀ decisions instrument
11,"sensors 2023, 23, 7824 11 of 14 that are usually driven by cost."
11,it shows how the simulator can be used to directly verify whether a given instrument design or configuration meets the accuracy or performance requirements of end-users before build and launch.
11,"the modular nature of the simulator enables a quick examination of spectral, spatial, and radiometric trade-offs without requir- ing highly complex simulators that are only applicable to a particular mission (see below)."
11,"the comparison between the smallsat and cubesat instruments provides quantitative performance metrics to support the use of larger, more expensive satellite instruments for the end-user-driven application under consideration."
11,this is a critical outcome in justifying mission specifications and costs for future and planned satellite missions.
11,"similar software tools, already described above, are inadequate in that they are limited to a specific sensor, to the extent that they can no longer be used to effectively assess design trade-offs from multiple configurations early in the design process [5,7–10]."
11,"such simulators include those for missions such as enmap [8,11], the fluorescence explorer (flex) [9], the far-infrared outgoing radiation understanding and monitoring (forum) [10] and sentinel-3 [12]."
11,"the selex galileo is a commercial simulator similar to that described here, which is designed for early phase 0/a missions to enable the rapid dimensioning of new optical instruments and to trace the link to user requirements [5]."
11,there are also several other commercially available simulators with various degrees of sophistication (see references in [5]).
11,"as the simulator described here is a prototype, a detailed comparison with existing alternatives is likely premature."
11,"rather, this paper demonstrates tangible outcomes related to sensor design affecting aquatic applications."
11,the prototype simulator should be improved and developed further as a tool for both instrument design trade-off studies and for research and development applications.
11,"for aquatic applications, functionality implementing realistic adjacency effects (stray light from bright targets surrounding water) and sun glint on water surfaces should be prioritized, as in [12], which have been neglected in the cases shown here."
11,"the simulator does not account for the impact of cloudy conditions (e.g., [10])."
11,"the implementation of advanced 3d radiative transfer models that simulate landscapes (e.g., [30,31]) not currently implemented in the prototype simulator, has the potential to provide even more realistic simulations in the future [4]."
11,"several improvements in the graphical user interface would facilitate easier use by engineers and scientists, similar to [32]."
11,further additional development of the prototype simulator for applications related to terrestrial environments is envisaged that would include terrain geometries and bio-optical models for vegetation and land surface types as forward modeling components [6].
11,"with further development, the prototype sim- ulator could be made available either commercially or open source [30,32] as a generalized, stable, complete, and user-friendly tool to support a broader range of eo applications, including ground sensing."
11,"this would help users understand important design trade-offs easily, quickly, reliably, and accurately in eo satellites and systems."
11,"author contributions: conceptualization, a.d., i.p. and r.s.; methodology, i.p., r.s., a.d., n.d., d.a., j.p., j.a., m.w.m. and w.w.; software, i.p., d.a. and n.d.; validation, n.d. and j.p.; formal analysis, i.p., j.p., n.d., j.a. and m.w.m.; writing—original draft preparation, m.w.m.; writing— review and editing, m.w.m., a.d., i.p., n.d., j.p., d.a., j.a., r.s., w.w., s.p. and s.g.; visualization, n.d., j.p., j.a., a.d. and m.w.m.; supervision, a.d., r.s., j.a., s.p. and s.g.; project administration, m.w.m. and a.d.; funding acquisition, a.d., r.s., j.a., s.p. and s.g."
11,all authors have read and agreed to the published version of the manuscript.
11,funding: this research was funded by the smartsat crc under project no.
11,3-13: aquawatch pathfinders: earth observation sensor design simulator testbed (end-to-end simulator).
11,lake hume water quality data were acquired through the geoscience australia and csiro collaborative inland water quality project 2017–2020.
11,w.w. was supported by an australian research council decra fellowship (de190101182).
11,institutional review board statement: not applicable.
11,informed consent statement: not applicable.
12,"sensors 2023, 23, 7824 12 of 14 data availability statement: requests for the simulator code and associated input data described in this report should be made to the smartsat crc (https://www.smartsatcrc.com/ (accessed on 11 september 2023)."
12,osoaa is available from https://github.com/cnes/radiativetransfercode- osoaa (accessed on 15 june 2022).
12,the sambuca algorithm is available from https://github. com/stevesagar/sambuca (accessed on 11 september 2023).
12,the australian bio-optical database is available from the csiro at https://doi.org/10.25919/rtd7-j815 (accessed on 11 september 2023).
12,the almi algorithm is available from https://github.com/geoscienceaustralia/dea-water-quality (accessed on 11 september 2023).
12,acknowledgments: administrative assistance and technical support were provided by csiro and smartsat crc.
12,"this work has been supported by the smartsat crc, whose activities are funded by the australian government’s crc program."
12,we acknowledge the contributions of three reviewers who helped to strengthen the manuscript.
12,conflicts of interest: the authors declare no conflict of interest.
12,"the funders had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript; or in the decision to publish the results."
12,appendix a the simulator natively outputs data in photon units.
12,these data require calibration to be converted to l toa .
12,the calibration process involves obtaining a reference radiance spectrum of a theoretical exposure of the instrument to a lambertian surface illuminated through extra-terrestrial solar irradiance.
12,one hundred (100) exposures were obtained at the nominal exposure time used in the scene (assuming a lambertian response) and a zero-second exposure time (to account for bias or instrument noise).
12,these data products were then used to generate across-swath calibration coefficients that were applied to obtain l toa as observed with the instrument.
12,the following methodology was used to perform a theoretical atmospheric correction: 1.
12,twenty points in the scene were randomly sampled to obtain the sensor view angle (θ) and the sun-sensor azimuth difference (φ).
12,"these values were then used to select the direction index and obtain water-leaving radiance (lw ), surface irradiance (ed (0+)), l toa , and upward atmospheric transmit- tance (tup )."
12,note: l toa obtained at this stage are the values that are input to the instrument model and are distinct from those output from the model.
12,the path radiance (l path ) is then calculated as follows:  l path = l toa − tup × lw (a1) 4.
12,the above equation is then rearranged to solve for lw (denoted lwac ) and applied to the instrument model toa radiance (l toa ( m)): l toa ( m) − l path lwac = (a2) tup 5.
12,"the remote sensing reflectance (rrs ), based on the water-leaving radiance normalized to the downwelling irradiance just above the water surface (ed (0+)), is then calculated as follows: l rrs = wac (a3) ed (0+) appendix b a four-component bio-optical model was used to model the inherent optical properties of water, which included water, phytoplankton, naps, and cdom."
12,the siops for naps and acdom were generated from average values of 55 measurements at lake hume [22].
12,the chl-a-specific siops for the cyanobacterium microcystis aeruginosa were used [33].
12,"for details of atmospheric and in-water parameters used for the hypothetical lake hume case,"
13,"sensors 2023, 23, 7824 13 of 14 see table a1."
13,"for the synthetic heron island scene, the chl-a concentration was 0.15 µg/l, absorption using cdom at 440 nm was 0.003 m−1 , and the concentration of naps was 1 mg/l."
13,a solar zenith angle of 20◦ was used.
13,table a1.
13,parameter definitions for hypothetical cyanobacterial bloom at lake hume for coupled water–atmosphere forward modeling.
13,"chl-a 1, 30, 10, 30, 50, 100 µg/l horizontal visibility 14 km non-algal particles 10 mg/l relative humidity 70% acdom (440) 1.0 m−1 cloud cover 0% phytoplankton type cyanobacteria altitude 0 m above sea level gas free atmosphere nap type generic gaseous absorption (not added) bathymetry optically deep date 21 june vertical distribution homogeneous time 11:00 a.m."
13,phase function fournier-forand sun zenith angle 60◦ climatology cloud-free winter day spatial resolution 1 pixel aerosol profile continental spectral resolution 10 nm aerosol vertical profile standard profile polarization yes aerosol optical thickness at 550 nm measured mean angular resolution 5◦ pressure 1012 mb references 1.
13,smartsat.
13,preliminary concept study for the satellite segment of aquawatch australia; smartsat aquawatch technical report no.
13,"1; smartsat: adelaide, australia, 2021."
13,committee on earth observation satellites (ceos).
13,"feasibility study for an aquatic ecosystem earth observing system; dekker, a.g., pinnel, n., eds."
13,"; commonwealth scientific and industrial research organisation: canberra, australia, 2018."
13,"kerekes, j.p."
13,"; landgrebe, d.a."
13,simulation of optical remote sensing systems.
13,ieee trans.
13,geosci.
13,remote sens.
13,"1989, 27, 762–771."
13,[crossref] 4.
13,"han, s."
13,"; kerekes, j.p."
13,overview of passive optical multispectral and hyperspectral image simulation techniques.
13,ieee j.
13,earth obs.
13,remote sens.
13,"2017, 10, 4794–4804."
13,[crossref] 5.
13,"coppo, p."
13,"; chiarantini, l."
13,"; alparone, l."
13,end-to-end image simulator for optical imaging systems: equations and simulation examples.
13,technol.
13,"2013, 2013, 295950."
13,[crossref] 6.
13,"verhoef, w."
13,"; bach, h."
13,simulation of hyperspectral and directional radiance images using coupled biophysical and atmospheric radiative transfer models.
13,remote sens.
13,environ.
13,"2003, 87, 23–41."
13,[crossref] 7.
13,"stratoulias, d."
13,"; balzter, h."
13,"; sykioti, o."
13,"; zlinszky, a."
13,"; tóth, v.r."
13,evaluating sentinel-2 for lakeshore habitat mapping based on airborne hyperspectral data.
13,"sensors 2015, 15, 22956–22969."
13,[crossref] 8.
13,"segl, k."
13,"; guanter, l."
13,"; rogass, c."
13,"; kuester, t."
13,"; roessner, s."
13,"; kaufmann, h."
13,"; sang, b."
13,"; mogulsky, v."
13,"; hofer, s."
13,eetes—the enmap end-to-end simulation tool.
13,ieee j.
13,earth obs.
13,remote sens.
13,"2012, 5, 522–530."
13,[crossref] 9.
13,"vicent, j."
13,"; sabater, n."
13,"; tenjo, c."
13,"; acarreta, j.r."
13,"; manzano, m."
13,"; rivera, j.p."
13,"; jurado, p."
13,"; franco, r."
13,"; alonso, l."
13,"; verrelst, j.; et al."
13,flex end-to-end mission performance simulator.
13,ieee trans.
13,geosci.
13,remote sens.
13,"2016, 54, 4215–4223."
13,[crossref] 10.
13,"sgheri, l."
13,"; belotti, c."
13,"; ben-yami, m."
13,"; bianchini, g."
13,"; carnicero dominguez, b."
13,"; cortesi, u."
13,"; cossich, w."
13,"; del bianco, s."
13,"; di natale, g."
13,"; guardabrazo, t.; et al."
13,the forum end-to-end simulator project: architecture and results.
13,atmos.
13,"2022, 15, 573–604."
13,[crossref] 11.
13,"guanter, l."
13,"; segl, k."
13,"; kaufmann, h."
13,simulation of optical remote-sensing scenes with application to the enmap hyperspectral mission.
13,ieee trans.
13,geosci.
13,remote sens.
13,"2009, 47, 2340–2351."
13,[crossref] 12.
13,"verhoef, w."
13,"; bach, h."
13,simulation of sentinel-3 images by four-stream surface–atmosphere radiative transfer modeling in the optical and thermal domains.
13,remote sens.
13,environ.
13,"2012, 120, 197–207."
13,[crossref] 13.
13,"gordon, h.r."
13,ocean color remote sensing systems: radiometric requirements.
13,in proc.
13,"spie 0924, recent advances in sensors, radiometry, and data processing for remote sensing; spie: bellingham, wa, usa, 1988; volume 924, pp."
13,151–167.
13,"wang, m."
13,"; gordon, h.r."
13,sensor performance requirements for atmospheric correction of satellite ocean color remote sensing.
13,"express 2018, 26, 7390–7403."
13,[crossref] [pubmed] 15.
13,"grøtte, m.e."
13,"; birkeland, r."
13,"; honoré-livermore, e."
13,"; bakken, s."
13,"; garrett, j.l."
13,"; prentice, e.f."
13,"; sigernes, f."
13,"; orlandić, m."
13,"; gravdahl, j.t."
13,"; johansen, t.a."
13,ocean color hyperspectral remote sensing with high resolution and low latency—the hypso-1 cubesat mission.
13,ieee transact.
13,geosci.
13,remote sens.
13,"2021, 60, 1–19."
13,[crossref] 16.
13,"rana, h."
13,"; brewin, r."
13,"; marais, e."
13,"; hey, j.v."
13,"; ghent, d."
13,"; bird, r."
13,a passive small satellite mission for monitoring ocean health.
13,ieee intl.
13,geosci.
13,remote sens.
13,"2022, 7351–7354."
14,"sensors 2023, 23, 7824 14 of 14 17."
14,"morrison, j.m."
14,"; jeffrey, h."
14,"; gorter, h."
14,"; anderson, p."
14,"; clark, c."
14,"; holmes, a."
14,"; feldman, g.c."
14,"; patt, f.s."
14,seahawk: an advanced cubesat mission for sustained ocean colour monitoring.
14,in proc.
14,"spie 10000, sensors, systems, and next-generation satellites xx; spie: bellingham, wa, usa, 2016; volume 100001c, pp."
14,309–319.
14,"matthews, m.w."
14,"; kravitz, j.a."
14,"; pease, j."
14,"; gensemer, s."
14,determining the spectral requirements for cyanobacteria detection for the cyanosat hyperspectral imager with machine learning.
14,"sensors 2023, 23, 7800."
14,[crossref] 19.
14,"drusch, m."
14,"; del bello, u."
14,"; carlier, s."
14,"; colin, o."
14,"; fernandez, v."
14,"; gascon, f."
14,"; hoersch, b."
14,"; isola, c."
14,"; laberinti, p."
14,"; martimort, p.; et al."
14,sentinel-2: esa’s optical high-resolution mission for gmes operational services.
14,remote sens.
14,environ.
14,"2012, 120, 25–36."
14,[crossref] 20.
14,"nieke, j."
14,"; frerick, j."
14,"; stroede, j."
14,"; mavrocordatos, c."
14,"; berruti, b."
14,status of the optical payload and processor development of esa’s sentinel 3 mission.
14,ieee int.
14,geosci.
14,remote sens.
14,"2008, iv, 427–430."
14,"oliver, r.l."
14,"optical properties, of waters in the murray-darling basin, south-eastern australia."
14,freshw.
14,"1990, 41, 581–601."
14,[crossref] 22.
14,"drayson, n."
14,"; anstee, j."
14,"; botha, h."
14,"; kerrisk, g."
14,"; ford, p."
14,"; wojtasiewicz, b."
14,"; clementson, l."
14,"; mclaughlin, j."
14,"; hutton, m."
14,"australian aquatic bio-optical dataset with applications for satellite calibration, algorithm development and validation."
14,data br.
14,"2022, 44, 108489."
14,[crossref] 23.
14,"anstee, j."
14,"; botha, h."
14,"; cherukuru, n."
14,"; clementson, l."
14,"; oubelkheir, k."
14,"; schroeder, t."
14,"; blondeau-patissier, d."
14,"; ford, p."
14,"; brando, v."
14,"; dekker, a.g.; et al."
14,"coastal water quality laboratory and in situ measurements of siops (activity 2.1) and substratum (activity 2.2). v1; csiro: canberra, australia, 2020."
14,"chami, m."
14,"; lafrance, b."
14,"; fougnie, b."
14,"; chowdhary, j."
14,"; harmel, t."
14,"; waquet, f."
14,osoaa: a vector radiative transfer model of coupled atmosphere-ocean system for a rough sea surface application to the estimates of the directional variations of the water leaving reflectance to better process multi-angular satellite sensors data over the ocean.
14,"2015, 23, 27829–27852."
14,"shettle, e.p."
14,"; fenn, r.w."
14,models for the aerosols of the lower atmosphere and the effects of humidity variations on their optical properties (no.
14,"676); optical physics division, air force geophysics laboratory: hanscomb afb, ma, usa, 1979."
14,"müller, s."
14,"; schüler, l."
14,"; zech, a."
14,"; heße, f."
14,gstools v1.3: a toolbox for geostatistical modelling in python.
14,geosci.
14,model dev.
14,"2022, 15, 3161–3182."
14,[crossref] 27.
14,"brando, v.e."
14,"; anstee, j.m."
14,"; wettle, m."
14,"; dekker, a.g."
14,"; phinn, s.r."
14,"; roelfsema, c."
14,a physics based retrieval and quality assessment of bathymetry from suboptimal hyperspectral data.
14,remote sens.
14,environ.
14,"2009, 113, 755–770."
14,[crossref] 28.
14,"brando, v.e."
14,"; dekker, a.g."
14,"; park, y.j."
14,"; schroeder, t."
14,adaptive semi-analytical inversion of ocean color radiometry in optically complex waters.
14,"2012, 51, 2808–2833."
14,[crossref] [pubmed] 29.
14,"seegers, b.n."
14,"; stumpf, r.p."
14,"; schaeffer, b.a."
14,"; loftin, k.a."
14,"; werdell, p.j."
14,performance metrics for the assessment of satellite data products: an ocean color case study.
14,"2018, 26, 7404–7422."
14,[crossref] 30.
14,"qi, j."
14,"; xie, d."
14,"; yin, t."
14,"; yan, g."
14,"; gastellu-etchegorry, j.p."
14,"; li, l."
14,"; zhang, w."
14,"; mu, x."
14,"; norford, l.k."
14,less: large-scale remote sensing data and image simulation framework over heterogeneous 3d scenes.
14,remote sens.
14,environ.
14,"2019, 221, 695–706."
14,[crossref] 31.
14,"lyu, z."
14,"; goossens, t."
14,"; wandell, b.a."
14,"; farrell, j."
14,validation of physics-based image systems simulation with 3-d scenes.
14,ieee sens.
14,"2022, 22, 19400–19410."
14,[crossref] 32.
14,"auer, s."
14,"; bamler, r."
14,"; reinartz, p."
14,raysar-3d sar simulator: now open source.
14,ieee int.
14,geosci.
14,remote sens.
14,"2016, 6730–6733."
14,[crossref] 33.
14,"matthews, m.w."
14,"; bernard, s."
14,"; evers-king, h."
14,"; lain, l.r."
14,distinguishing cyanobacteria from algae in optically complex inland waters using a hyperspectral radiative transfer inversion algorithm.
14,remote sens.
14,environ.
14,"2020, 248, 111981."
14,"[crossref] disclaimer/publisher’s note: the statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of mdpi and/or the editor(s)."
14,"mdpi and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content."
